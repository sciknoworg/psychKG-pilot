You are an expert in psychology and computational knowledge representation. Your task is to extract key scientific information from psychology research articles to build a structured knowledge graph.

The knowledge graph aims to represent the relationships between psychological **topics or constructs** and their associated **measurement instruments or scales**. Specifically, for each article, extract information in the form of triples that capture:

1) The psychological topic or construct being studied
2) The measurement instrument or scale used to assess it
3) A brief justification (1–3 sentences) from the article text supporting this measurement link

Guidelines:
- Extract meaningful **phrases** (not full sentences or vague descriptions) for both `topic_or_construct` and `measured_by`, suitable for inclusion in a knowledge graph.
- Include a short justification for each extraction that clearly supports the connection.
- If the article does not discuss psychological constructs and how they are measured (e.g., no mention of constructs, instruments, or scales), return an empty list `[]`.

Input Paper:
"""



Most of our decisions are guided by beliefs we acquire based on perceptual and reward information about the environment. For example, when learning whether one likes a new pastry in a bakery, one has to form an association between the type of pastry based on perceptual information and the experienced taste when eating it. Crucially, this learning process can be quite challenging when stimuli such as different sorts of pastries cannot be easily distinguished due to perceptual uncertainty, and one might learn an incorrect stimulus-reward association. Therefore, taking into account perceptual uncertainty during reward-based learning is crucial for adaptive behavior 
(Bruckner et al., 2020;
Daw & Dayan, 2014;
Ganesh et al., 2024;
Ma & Jazayeri, 2014;
Summerfield & Tsetsos, 2012)
.
One approach to addressing this issue is to combine perceptual inference with reinforcement learning. During perceptual inference, a belief state can be computed, quantifying the probability of a particular state (such as the type of pastry) based on observations. This enables a precise quantification of how well different states and stimuli in the environment can be distinguished. Subsequently, learning can operate on belief states. Once an outcome has been observed, the belief state regulates how much credit each state receives. Specifically, the belief state can be used to regulate how much one learns from a prediction error, reflecting the difference between the actual and the experienced reward 
(Bruckner et al., 2020;
Chrisman, 1992;
Ez-zizi et al., 2023;
Ganesh et al., 2024;
Lak et al., 2017;
Larsen et al., 2010)
. We have recently shown that when the belief state clearly favors a state (low uncertainty), participants update their beliefs more strongly in response to a prediction error (higher learning rate). This was in contrast to situations with higher state uncertainty, in which participants learned more slowly 
(Ganesh et al., 2024)
. These results are generally in line with prior work suggesting a link between belief state and the regulation of learning from prediction errors 
(Babayan et al., 2018;
Bruckner et al., 2020;
Colizoli et al., 2018;
Gershman & Uchida, 2019;
Lak et al., 2017
Lak et al., , 2020
Starkweather et al., 2017)
. Here, we investigate the physiological mechanisms that may support adaptive learning under perceptual uncertainty.
The arousal systems of the brainstem, such as the locus coeruleus-norepinephrine system, are in a good position to control learning under uncertainty. These systems are recruited by specific forms of uncertainty 
(Aston-Jones & Cohen, 2005;
Dayan & Yu, 2006
; A. J. 
Yu & Dayan, 2005)
, and could play a key role in the dynamic, uncertainty-dependent regulation of learning rates 
(Nassar et al., 2012)
. Through their widespread ascending projections to the cerebral cortex, they shape local and large-scale network interactions 
(Berridge & Waterhouse, 2003;
Pfeffer et al., 2022;
Podvalny et al., 2021;
Van Den Brink et al., 2019)
, and synaptic plasticity mechanisms on different timescales 
(Bear & Singer, 1986;
Berridge & Waterhouse, 2003;
Marzo et al., 2009;
Nadim & Bucher, 2014;
Rasmussen, 2000;
Reynolds et al., 2001;
Reynolds & Wickens, 2002;
Vetencourt et al., 2008)
 in the cortex. This potentially makes them a key neuromodulatory mechanism supporting learning under perceptual uncertainty.
The activity of brainstem arousal systems can be tracked non-invasively by measuring nonluminance-mediated changes in pupil size 
(De Gee et al., 2017;
Joshi et al., 2016;
McGinley et al., 2015;
Reimer et al., 2016)
. Several studies show that pupil responses to outcomes encode prediction errors and surprise governing learning in uncertain and changeable environments 
(De Berker et al., 2016;
Nassar et al., 2012;
O'Reilly et al., 2013;
Preuschoff, 2011;
Van Slooten et al., 2018)
. Moreover, different forms of uncertainty relevant to learning and decision-making are reflected in pupil-linked arousal responses 
(Colizoli et al., 2018;
De Berker et al., 2016;
Krishnamurthy et al., 2017;
Nassar et al., 2012;
Urai et al., 2017;
Van Slooten et al., 2018)
. Learning and decision-making often take place under perceptual uncertainty over stimuli or states due to ambiguous sensory information (e.g., two very similar types of pastries). In this case, a belief about the state (i.e., belief state) can be computed to quantify how confidently the states can be distinguished (e.g., 40% pastry A, 60% pastry B). Belief states that are more similar mean higher state uncertainty. In contrast, state uncertainty is lower when stimuli or states can be more clearly distinguished. a| Consequently, under lower state uncertainty (dark green line), the learning rate (LR) tends to be higher, leading to larger updates for a given prediction error. In contrast, under higher state uncertainty (light green line), learning rates are lower. b| We hypothesized that this adaptive learning mechanism is supported by changes in arousal due to uncertainty driving how reward information is processed and used for further belief updating. Changes in arousal levels are known to reflect a prediction-error signal (see gray curve) and are associated with uncertain environments. Here, we examine whether pupil-linked arousal encodes a prediction error that is modulated by uncertainty over the belief state. Lower levels of uncertainty are associated with an up-regulated expression of prediction error in the arousal signal (dark green curve vs. gray curve), and higher levels are linked with mitigated representation of prediction errors in the arousal level (light green curve vs. gray curve).
We built upon these findings and hypothesized that pupil responses reflect uncertaintyweighted prediction errors during reinforcement learning under perceptual uncertainty 
(Fig. 1)
. In support of our hypothesis, we show that the uncertainty reflected in a belief state modulates how strongly the pupil reacts to prediction errors. Our study suggests that arousal systems are responsive to state inference under perceptual uncertainty, regulate the computations of prediction errors accordingly, and support adaptive learning by combining perceptual and reward information through a shared neural mechanism.


Results


Task and learning behavior
To investigate if pupil-linked arousal plays a role in belief-state-guided learning, we analyzed behavioral and pupil data of 47 participants (28 female, 10 male, 9 non-binary; mean age = 25.09 ± 0.67 standard error of the mean (SEM); range: 18-40) who completed the uncertaintyaugmented Gabor-Bandit task 
(Bruckner et al., 2020;
Ganesh et al., 2024)
. Each trial in the task consisted of three stages that we briefly summarize here. The main aim of the task was to maximize rewards, which required that subjects accurately learn reward probabilities from feedback. In the choice phase, participants were presented with two Gabor patches and asked to choose the one that maximized rewards. In the feedback phase, they received binary reward feedback. Finally, in the slider phase, they reported their reward probability estimate with a slider ranging from 0 to 100. The reported reward probability reflected the participants' updated belief after receiving the reward feedback. This allowed us to measure learning from trial to trial ( 
Fig. 2a
). Below, we provide a more detailed explanation of the task structure.
To maximize rewards, participants had to learn the reward probability, which was governed by an underlying relationship between each trial's state, participants' actions, and the obtained reward 
(Fig. 2b
). Each trial belonged to a hidden state of 0 or 1. The state determined the contrast-difference level on that trial. In state 0, the right patch had a higher contrast level compared to the left patch. In state 1, the left patch had a higher contrast level than the right one. The contrast difference between stimuli varied between trials, and participants had to choose the patch with the weaker (half of blocks) or stronger contrast (other half of blocks) to obtain the most reward. For each correct choice, participants received positive feedback with either a 90 % or 70 % probability. Positive feedback after wrong choices was given with the respective complementary probabilities (10 and 30 %, respectively). The reward probability was governed by an underlying relationship between each trial's state, participants' actions, and the obtained reward 
(Fig. 2b)
. Please note that participants were not aware of the mapping between the contrast of the patches and the reward probability. Thus, they were required to re-learn it in each block of trials. Finally, participants used the slider to report their reward probability estimates on a trial-by-trial basis.
We induced uncertainty over the perceptual features of the Gabor patches by manipulating contrast-difference levels on a trial-by-trial basis. The contrast differences were sampled from a uniform distribution. Belief states were more uncertain when contrast differences were smaller (patches looked more similar). In contrast, state uncertainty was lower in trials with larger contrast differences. Next to manipulating state uncertainty across trials, the task featured two levels of reward uncertainty governed by a "contingency" parameter µ. Half of the blocks had higher reward uncertainty with 70 % reward probability (e.g., contingency parameter µ = 0.7) and lower reward uncertainty with 90 % reward probability (µ = 0.9). Thus, the reward manipulation resulted in two task conditions ( 
Fig. 2a inset)
.
To ensure that participants understood the task and learned to choose the more rewarding option, we analyzed their subjective estimate of the reward probability. We plotted mean learning curves based on participants' slider responses, which showed that participants updated their beliefs about the reward probability in line with the feedback 
(Fig. 2c)
. Participants approached the actual underlying probability across both task conditions (high reward uncertainty: mean = 0.64 ± 0.01, t 45 = 9.55, p < 0.001, Cohen's d = 6.35, low reward uncertainty: mean = 0.72 ± 0.02, t 45 = 13.64, p < 0.001, Cohen's d = 6.6). There was a significant effect of task condition on the slider responses whereby the reported reward probability was significantly lower in the high reward-uncertainty condition (t 90 = −3.51, p < 0.001, Cohen's d = −0.73). Consistent with these results, participants also learned to choose the correct option (i.e., more rewarding) more often 
(Fig. S1
). Expanding on these findings about participants' learning behavior, we next tested whether state uncertainty impacted learning rates.
Participants used variable learning rates modulated by the belief state. Based on participants' slider responses, we first computed each trial's prediction error and belief update (see Data preprocessing, for more details). The learning rate (LR) is then computed as the extent to which participants updated their belief about the reward probability for that trial's prediction error. Moreover, we approximated belief states contingent on the contrast-difference level, wherein lower difference resulted in higher state uncertainty. To check if this uncertainty impacted single-trial learning rates on average, we calculated averages for increasing contrastdifference bins and found that participants learned more when belief states were less uncertain ( 
Fig. 2d
; Pearson's r 08 = 0.93, p < 0.001). . Experimental task and learning behavior. a| Uncertainty-augmented Gabor-Bandit task. Participants were instructed that the aim of the task was to maximize rewards. A pair of Gabor patches with varying contrast differences was presented on each trial. Participants made an economic choice between the patches (choosing the high-or low-contrast patch). After each choice and a jittered delay, auditory reward feedback was presented. Finally, participants reported their estimate of the reward probability (for a hypothetical choice) by using a slider between 0 (low reward probability) and 100 percent (high reward probability). Inset plot. We used two experimental conditions. The two conditions differed in terms of reward uncertainty. In half of the blocks, reward uncertainty was low, and when the "correct" patch was chosen, the reward probability was 90%. In contrast, reward uncertainty was higher in the other half of the blocks (70% reward probability for a correct choice). b| Task contingency. To maximize rewards, participants were required to learn the underlying state-action-reward contingency for each block of trials. Each trial could belong to either state 0 or 1. In state 0, the patch on the right had a higher contrast level, and vice versa in state 1. Conditional on the state, the exact contrast difference was sampled from a uniform distribution ranging from low difference values that were virtually in-discriminable (higher uncertainty) to higher values (lower uncertainty). The contingency parameter determines the probability of a reward for a given state-action combination. In this example, the reward probability is higher on choosing the left patch in state 0. Similarly, the reward probability is higher on choosing the right patch in state 1. Thus, to learn this underlying relationship, participants need to use the obtained reward to estimate the probability with which a given action is likely to be rewarded conditional on the current trial's state. Participants face a considerable amount of uncertainty in trials with smaller contrast differences making state inference challenging. 
Figure 2
 (Continued). c| Learning curve. Mean ± standard error of the mean (SEM) of the reported reward probability based on the slider plotted across trials. Across the two conditions, participants approached the actual reward probability albeit with some level of underestimation. Subjects' reported reward probability was lower in the condition with high reward uncertainty compared to the low-reward uncertainty condition. d| Mean single-trial learning rates. Here, we illustrate the learning rate across contrast-difference bins, where lower bins correspond to more uncertain belief states (high state uncertainty). Subjects used higher learning rates in the larger contrast-difference bins, suggesting more learning under more distinguishable belief states. e| To decompose the effects of prediction errors and belief states on learning, we used a regression model 
(Ganesh et al., 2024)
. The model included a term expressing the average influence of the prediction error on the update (fixed LR). Positive coefficients show that participants have a tendency to report larger updates after larger prediction errors. f| The model also included a term estimating the influence of belief states on learning (belief-state-adapted LR). Positive coefficients show that participants adjust the learning rates to the level of contrast difference of a given prediction error. g| Regression fits for an example participant across three levels of contrast difference demonstrate that belief states modulated the learning rate. Higher contrast differences led to larger updates compared to trials with lower contrast differences.
We next decomposed single-trial belief updates to examine the extent to which the belief state is used to weigh prediction errors while learning. We used a previously developed regression model, based on which we quantified single-trial belief updates as a linear function of prediction errors 
(Ganesh et al., 2024)
. The model estimated a fixed learning rate (quantifying error-driven learning) and a belief-state-adapted learning rate (quantifying the dynamic impact of belief states in interaction with prediction errors) and controlled for the role of nuisance variables on learning (for more details, see Behavioral regression model). We fit the model to participants' single-trial updates and found that participants used positive fixed learning rates on average (mean = 0.09 ± 0.018, t 46 = 5.1, p < 0.001, Cohen's d = 0.74; 
Fig. 2e
) indicating more learning from larger prediction errors. Next to this, we found that participants learned more for larger contrast differences (i.e., lower uncertainty over the belief state) for a given prediction error as indicated by the positive belief-state-adapted-LR coefficient (mean = 0.1 ± 0.019, t 46 = 5.27, p < 0.001, Cohen's d = 0.77; 
Fig. 2f
). We illustrate this result by plotting the relationship between prediction errors and updates for varying contrast-difference levels for an example participant ( 
Fig. 2g
), which shows a systematic increase in learning rates with lower uncertainty. Together, these results show that humans use a mixture of fixed learning driven by prediction errors and dynamic learning conditional on the belief state, replicating the results of our previous work 
(Ganesh et al., 2024)
. Finally, to quantify the performance of our model compared to a baseline model with intercept only, we computed the average partial -R 2 . This yielded a partial -R 2 = 0.42, suggesting that our model captured the behavioral data well 
(Fig.  S5
). Building upon these insights, we next investigated the role of pupil-linked arousal dynamics in the adaptive learning process.


Feedback-related pupil dilation reflects prediction errors
The central question addressed in this study is whether pupil-linked arousal contributes to adaptive learning by means of encoding uncertainty-weighted prediction errors. We first quantified the arousal level as the baseline-corrected pupil signal on a given trial ( 
Fig. 3a
 and 
Fig. S10
 for single-subject pupil responses). Pupil responses during the choice phase (time-locked to patch presentation) are likely, at least in part, driven by decision formation and the associated uncertainty 
(De Gee et al., 2014;
Urai et al., 2017)
. By contrast, pupil responses to feedback onset reflect learning-related computations such as surprise or the encoding of a reward prediction error 
(Nassar et al., 2012;
Preuschoff, 2011;
Van Slooten et al., 2018)
. We directly compared pupil responses locked to feedback onset (for details see, Quantifying feedback-related pupil signal) across two bins of absolute prediction errors and found that pupil dilation was significantly 
Figure 3
. Feedback-locked pupil dilation. a| Baseline-corrected time course of mean ± standard error of the mean (SEM) pupil dilation throughout the trial. The positive response post feedback onset suggests the encoding of a reward prediction error, while patch and response-locked dilation reflects task-based decision-making processes. b| Mean pupil response to feedback onset was significantly larger for trials with higher compared to lower prediction errors. c| Prediction error-related pupil dilation for trials with low and high state uncertainty. To examine if state uncertainty modulates the extent to which prediction errors scaled pupil dilation, we regressed pupil dilation onto absolute prediction errors for each time point post feedback onset for high and low stateuncertainty trials separately. Regression coefficients were significantly larger for lower state-uncertainty trials compared to trials with higher state uncertainty. This result suggests that prediction errors are down-regulated as a function of state uncertainty. The gray line indicates p-values from a cluster-based permutation test of the difference between two groups of trials, after accounting for multiple comparisons.
larger for larger prediction errors (dark purple curve in 
Fig. 3b
, p = 0.004, see Permutation testing for more details). This finding is in line with the idea that larger errors signal stronger surprises.
We then examined if the prediction-error component of the pupil response is modulated by the belief state. To this end, we used a model-based approach whereby we fit absolute prediction errors and other control variables (see Pupil regression analysis for more details on the control variables) to individual subjects' pupil dilation in a sample-by-sample fashion across two bins of high and low state uncertainty 
(Urai et al., 2017
; see Binned regression approach and 
Fig. S2
 for more details on the binned regression approach). By comparing beta coefficients that quantified the extent to which prediction errors modulated pupil responses, we found that the relationship between absolute prediction errors and pupil dilation is systematically down-regulated for higher uncertainty over the belief state (light green curve in 
Fig. 3c
, p = 0.004, see Permutation testing for more details and 
Fig. S3
 showing that the mean absolute prediction errors were not significantly different across the two bins). This potentially reveals uncertainty-weighted prediction errors, where higher state uncertainty calls for lower levels of error-evoked arousal. To examine this idea in more detail, we next turn to an analysis approach with continuous levels of belief states.


Pupil signal reveals uncertainty-weighted prediction errors
In a model-based regression analysis, we found further evidence of uncertainty-weighted prediction errors 
(Fig. 4
). While our previous analysis approximated this relationship by comparing high-and low-uncertainty trials 
(Fig. 3)
, our next analysis directly tested for the relationship between prediction errors and contrast differences. We used a linear regression model for each subject across the time course of feedback-locked pupil dilation 
(Krishnamurthy et al., 2017;
Nassar, Bruckner, & Frank, 2019;
Urai et al., 2017;
Van Slooten et al., 2018)
. The model estimates the temporal evolution of the extent to which pupil dilation changes for different re- 
Figure 4
. Feedback-locked pupil signal encodes belief-state-weighted prediction errors. a| We developed a regression model (see inset equation on top of the plot) and fit it to sample-by-sample pupil response to feedback. Positive coefficients for absolute prediction errors |δ| show a systematic increase in the pupil response for larger prediction errors showing that prediction errors are reflected in the pupil response. b| Positive coefficients for the interaction between absolute prediction errors and contrast differences (i.e., belief-state-weighted prediction errors) indicate that pupil responses increased significantly for larger contrast-difference trials (i.e., lower state uncertainty) compared to smaller contrast differences for a given level of prediction error. This finding suggests that prediction errors are modulated by the belief state. c| Across three levels of contrast-difference values, modelpredicted responses for a given prediction error demonstrate that state uncertainty plays a key role in regulating the pupil response. Higher contrast differences (i.e., on average, lower state uncertainty) led to increased pupil dilation compared to trials with lower contrast differences. The gray line indicates p-values from a cluster-based permutation test of the difference between each time course and zero.
gressors. We first accounted for the impact of absolute prediction errors by adding a main effect to the model. To model the modulatory role of the belief state, we added a key regressor that captured the interaction effect between contrast difference and absolute prediction error on a given trial ( 
Fig. 4
 inset equation, where |δ| refers to absolute prediction error). We also added a set of nuisance regressors to simultaneously control for the impact of the main effect of the belief state, reaction times, slider responses, and gaze position (for more details on the model, see Pupil regression analysis and 
Fig. S4
 for the effect of control variables on the pupil response).
We found that pupil dilation varied systematically as a function of absolute prediction errors. That is, larger prediction errors resulted in a significant increase in the magnitude of pupil dilation post feedback (PE-modulated pupil coefficient in 
Fig. 4a
, p < 0.001, see Permutation testing for more details). The positive influence of prediction errors reflects an arousal-based signal for error-driven learning dynamics reminiscent of the behavioral fixed learning rate ( 
Fig.  2e)
.
More importantly, we determined that uncertainty over the belief state modulates the pupil responses to prediction errors during learning. Positive coefficients for the interaction of absolute prediction error and contrast difference indicated that larger contrast differences (more certain belief states) led to increased pupil dilation for a given prediction error (BS-weighted PE coefficient in 
Fig. 4b
, p = 0.02, see Permutation testing for more details). In other words, for a given prediction error, pupil dilation is attenuated on trials with higher state uncertainty and enhanced with decreasing uncertainty levels. This suggests that via regulated arousal, state uncertainty flexibly changes how incoming reward information is translated into learning. This result qualitatively complements the behavioral adaptive learning rate 
(Fig. 2f)
.
To demonstrate prediction-error weighting in the arousal signal further, we computed feedback-locked pupil dilation based on our model-estimated coefficients 
(Fig. 4c
). Mean posterior dilation plotted across three contrast-difference values showed that lower model-predicted pupil dilation accompanied higher levels of uncertainty (smaller contrast-difference values). Taken 
Figure 5
. Pupil-linked arousal explains belief updating beyond our behavioral model. a| We examined the relationship between pupil-linked arousal and residual learning, which captures additional variance in behavior after having accounted for the effects explained by our behavioral regression model (see the inset equation on top of the plot). We include the posterior-update coefficient that summarizes the model-based behavioral predictions, allowing us to control for variance in updates explained by the behavioral regression model. b| Feedback-locked pupil dilation significantly contributed to explaining residual learning from our behavioral model. This shows that fluctuations in pupil-linked arousal levels explain variance in learning behavior beyond the behavioral regression model. This suggests that higher arousal levels are related to larger belief updates, potentially because newly arriving information is considered more strongly than under lower levels of arousal. The gray line indicates pvalues from a cluster-based permutation test of the difference between each time course and zero.
together, our finding suggests that pupil dilation reflects an uncertainty-weighted prediction error that could drive adaptive learning. Please note that we also used versions of our current regression model to analyze the pupil signal after controlling for the role of baseline pupil signal and reaction times. Results indicated that the estimated coefficients converge with our current results ( 
Fig. S7
 and 
Fig. S8
; see Control regression models for more details).


More arousal is linked to larger belief updates
Finally, we directly examined the link between pupil responses and behavioral updating. Based on our findings, we reasoned that since dynamic information processing is key for adaptive learning and is tightly associated with arousal levels, fluctuations in pupil dilation may be related to differences in update magnitude. To test this, we investigated whether variance in absolute single-trial updates has a systematic relationship with pupil-linked arousal after accounting for key regressors from our behavioral model ("posterior updates"). We applied a regression model explaining belief updating, but in this case, we directly took into account pupil dilation in the model. Moreover, by adding posterior updates as regressors ( 
Fig. 5a
, p < 0.001), our analysis ensured that pupil-linked arousal is used to solely explain residual learning behavior beyond our behavioral model. Applying this model, we found that arousal levels modulate belief updating beyond the variance captured in our behavioral analyses. In this model, the main effect of pupil dilation represented the direct relationship between arousal and updates (for more details, see Analyzing residual learning). Larger pupil dilation in the later periods post feedback co-varied positively with participants' single-trial updates 
(Fig. 5b
, p = 0.008, see Permutation testing for more details). This suggests that higher general levels of arousal increase update magnitude so that newly incoming information is more strongly considered for learning. Residual learning is better explained by such fluctuations in the arousal level that occur later during the learning window ( 
Fig. 5b)
. In sum, pupil dilation not only reflects task-related learning computations but also intrinsic arousal fluctuations, which explain learning beyond those captured by our behavioral model.


Discussion
Recent work has indicated that the arousal systems of the brainstem may play an important role in controlling adaptive behavior in an uncertain world. Here, we examined whether phasic pupil-linked arousal supports adaptive learning under perceptual uncertainty. Our results show that pupil responses during learning are flexibly modulated by uncertainty over stimulus discriminability (belief state) while encoding prediction errors. This suggests that pupil-linked arousal represents prediction errors weighted by the belief state. The dynamic regulation of prediction errors might help the brain to flexibly adjust reward learning to varying degrees of uncertainty due to ambiguous perceptual information.
Our findings suggest that phasic pupil-linked arousal encodes an uncertainty-weighted prediction-error signal. Accordingly, the pupil response reflects computations that integrate perceptual information encoded by the belief state with reward information through prediction errors. Such an uncertainty-mediated arousal signal flexibly changes how incoming reward information is treated during learning. This could reveal an adaptive computational mechanism for slower and more cautious learning when stimuli cannot be confidently dissociated in the presence of perceptual uncertainty 
(Bruckner et al., 2020;
Drevet et al., 2022;
Ganesh et al., 2024)
.
While our results are the first to demonstrate that phasic pupil-linked arousal encodes uncertainty-weighted prediction errors during adaptive learning, previous work has hinted that this might be the case. Several studies reported pupil correlates of prediction errors and surprise, independent of perceptual uncertainty 
(Browning et al., 2015;
De Berker et al., 2016;
Nassar et al., 2012;
O'Reilly et al., 2013;
Preuschoff, 2011;
Van Slooten et al., 2018)
. The relationship between belief states and prediction errors is consistent with a perceptual decision-making study that interpreted outcome-locked pupil responses in terms of an uncertainty-weighted prediction error 
(Colizoli et al., 2018)
. Finally, previous animal work measuring dopaminergic activity showed evidence of uncertainty-weighted prediction errors in mice and monkeys 
(Lak et al., 2017
(Lak et al., , 2020
.
More generally, our results add to the current view that state inference is a ubiquitous mechanism for adaptive learning under uncertainty. Recent studies have also shown prediction-error weighting in tasks in which uncertainty arises from ambiguous reward information 
(Babayan et al., 2018;
Starkweather et al., 2017)
. Together with our findings, this suggests that reinforcement learning operates on belief states when the states of the environment are only partially observable. Specifically, learning under uncertainty involves two key processes: first, the brain computes the current belief state based on the available perceptual information, which then serves as input for the reinforcement-learning system 
(Daw & Dayan, 2014;
Dayan & Daw, 2008;
Wilson et al., 2014)
. In the case of our study, this is reflected in an uncertainty-weighted prediction error signal. This dynamic between state inference and learning seems to function consistently, regardless of whether the source of uncertainty primarily stems from sensory information, reward information, or other sources.
Further pupillometry research could expand on these considerations and examine whether task-evoked arousal encodes uncertainty-weighted prediction errors when uncertainty primarily arises from ambiguous reward magnitudes or timing. Moreover, future studies could examine where in the brain belief states are computed and passed on to regulate learning and decisionmaking. Plausible candidate areas are the orbitofrontal cortex (OFC), hippocampus, and entorhinal cortex, wherein neuromodulatory surprise signals can mediate state inference (L. Q. 
Yu et al., 2021)
. Theoretical and empirical work suggests that the OFC represents hidden-state information 
(Nassar, McGuire, et al., 2019;
Schuck et al., 2016;
Wilson et al., 2014)
, and it will be important to better understand whether the OFC also represents state uncertainty that modulates prediction errors for reinforcement learning.
Our findings potentially involve key neuromodulatory systems. Mounting evidence identifies the locus coeruleus-norepinephrine (LC-NE) system, a core component of the arousal network, as a likely contributor to phasic pupil responses, which influences the central arousal state through its extensive and rich cortical projections 
(Aston-Jones & Cohen, 2005;
Gilzenrat et al., 2010;
Joshi & Gold, 2020;
Joshi et al., 2016;
Megemont et al., 2022;
Murphy et al., 2011
Murphy et al., , 2014
Reimer et al., 2016)
. Acetylcholine has also been related to LC activity, which is quantified as changes in both tonic 
(Reimer et al., 2016)
 and task-evoked pupil responses 
(Sara, 1998)
. This is in line with influential theoretical work proposing that norepinephrine and acetylcholine track different forms of uncertainty that regulate learning behavior 
(Dayan & Yu, 2006;
Sara, 1998;
A. J. Yu & Dayan, 2005)
. Moreover, the dopaminergic system, known for its role in reward-and error-related computations and with connections to the LC, has been linked to changes in pupil diameter 
(De Gee et al., 2017;
Manohar & Husain, 2015)
. Other serotonergic regions and the superior and inferior colliculi have also been tied to pupil-linked arousal 
(Cazettes et al., 2021;
Joshi et al., 2016;
Reimer et al., 2016)
. This suggests a complex interplay between different neuromodulatory systems in regulating arousal. In humans, future work using functional magnetic resonance imaging (fMRI) data from a wider brainstem network (De Gee et al., 2017) could help identify the neural source behind uncertainty-regulated pupil responses and its link to learning-rate adjustments.
We next discuss the potential role of cognitive effort and the relationship to uncertaintyweighted prediction errors. Because pupil dilation could reflect cognitive effort, one potential interpretation of our results is that lower prediction-error signals on high-uncertainty trials could be explained by the expenditure of higher effort on such trials. However, at least two arguments speak against this interpretation. First, we have included contrast differences as main effects in our pupil analyses. If participants invested higher cognitive effort on high-uncertainty trials (smaller contrast differences), we would expect significant main effects of contrast differences. However, neither during the presentation of the Gabor patches 
(Fig. S9
) nor in response to reward feedback 
(Fig. S4
) did we find significant main effects of contrast difference. Second, previous studies have found that pupil responses are larger in high-effort trials 
(Van Der Wel & Van Steenbergen, 2018)
. In contrast, the uncertainty-weighted prediction-error signal shows that more uncertainty (hence potentially more effort) calls for lower pupil responses. Therefore, our findings seem inconsistent with the interpretation that down-weighted prediction-error signals for smaller contrast differences reflect the investment of more effort.
Finally, our analysis also showed that in addition to encoding uncertainty, fluctuations in the phasic pupil response capture variability in learning beyond what could be explained through behavioral analyses alone. This indicates that pupil-linked arousal not only reflects task-based computations but also accounts for fluctuations in learning. This finding is in line with the study by De Gee et al. 
2017
showing that seemingly random variability in choice behavior can partly be explained by phasic responses of brainstem arousal. Together, these lines of research converge on the view that arousal is a ubiquitous factor that exercises control over how the brain processes information for learning and decision-making.
In conclusion, we found support for the hypothesis that phasic pupil-linked arousal reflects prediction errors modulated by belief states during reinforcement learning under perceptual uncertainty. This suggests that the arousal systems are key in the integration of uncertain perceptual and reward information and offers new insights into the psychophysiological mechanism behind adaptive belief updating.


Methods


Participants
We collected behavioral and pupillometry data from 50 participants (29 female, 11 male, 10 non-binary; mean age = 25.59 ± 0.6 SEM; range: 18-40). All participants were recruited from the local student participant pool of Freie Universität Berlin. Data from 3 participants were rejected since they performed with less than 50% accuracy. Thus, all further analyses were conducted on the data obtained from our effective study sample of 47 participants. For taking part in the study, participants were paid a standard rate of 12.00 e . Moreover, to incentivize their performance, participants received an extra bonus payment of up to 4.00 e , determined by their economic choice performance. The study was approved by the ethics committee of the Department of Education and Psychology at Freie Universität Berlin ("Effects of Perceptual Uncertainty on Value-Based Decision Making", protocol number: 121/2016). All participants reported normal or corrected-to-normal vision, seven reported currently being diagnosed with a psychiatric condition (e.g., depression, anxiety, schizophrenia) and none reported being diagnosed with a neurological condition (e.g., multiple sclerosis).


Experimental task
We used an isoluminant version of the Gabor-Bandit task from 
Ganesh et al. (2024)
 optimized for pupillometry.


Stimulus material
The task was programmed using PsychoPy (version 2022.2.5). The Gabor-Bandit task version of this study comprised three stages (economic decision-making, reward feedback, slider response) ( 
Fig. 2a)
. In the first stage, the stimulus material comprised a fixation dot and two Gabor patches presented on a screen with a gray background color (#808080). We set the stimulus properties of the Gabor patches using the in-built GratingStim function of PsychoPy. We used a sine texture with a spatial frequency of 8 cycles in height and a Gaussian mask. We set the orientation and phase offset of the Gabor-patch stimuli to 0°. To manipulate the contrast levels of the Gabor patches g, we adjusted the patches' visibility v, where 0 indicates that the patch is transparent (matching the background) and 1 that it is fully opaque. Consequently, the presented contrast level of each patch was a weighted combination of the stimulus properties z (as described above) and the background color h: g = vz + (1 − v)h. The mean visibility of both patches was kept at v = 0.5 across all trials (the average contrast value on each trial was 0.5 irrespective of the contrast difference). The mean contrast was constant across all trials, and Gabor-patch pairs were matched on luminance across all trials. This was verified using the SHINE toolbox in Matlab 
(Willenbockel et al., 2010)
 whereby pairs of Gabor patches with varying levels of contrast differences were tested to check if they matched on luminance levels. The stimuli was presented on a monitor with a refresh rate of 60 Hz and a length of 60.5 cm.


Experimental procedure
At the start of each trial, participants were asked to fixate on the fixation dot for a jittered time interval between 1.6 to 2.1 seconds. Participants were instructed to fixate on the dot throughout the trial and avoid blinking or making eye movements as much as possible. In the first stage of the trial, the choice gratings were presented for 0.5 seconds, while the fixation dot remained on the screen throughout. Following a jittered delay of 0.2 to 0.5 seconds, the fixation dot would turn into a square (Go cue), and participants were required to make the economic choice using the left and right cursor buttons of the computer keyboard. The diameter of the fixation dot and the length of the squared Go cue were matched across all trials. This ensured that there were no sudden shifts in the area of the screen covered by the fixation dot or the Go cue.
In the second trial stage after a variable delay of 0.5 to 1 second, participants were presented with audio feedback of winning either zero (descending tone from 950 to 350 Hz) or one (ascending tone from 350 to 950 Hz) point based on their economic choice for 0.25 seconds. In case of a missed trial, we used white noise as audio feedback. Please note that we rejected missed trials from our behavioral and pupillometry analysis. Participants were pre-trained to learn the association between the audio feedback and the number of points. Finally, in the third trial stage, the task included an additional probe phase. In this phase, participants were first presented with a slider to report their learned estimate of the reward probability after a delay of 1.5 seconds. Participants were instructed to use the delay to estimate how much they wanted to update their beliefs after the reward feedback. This allowed us to also measure the pupil signal in the "learning" window independent of movements made by the participant to make a slider response. Finally, participants reported their subjective estimate of the reward probability for a hypothetical choice using a slider. Participants completed 20 trials in each block of the task. The presentation order of blocks was randomized across participants. If a participant failed to respond to a trial, the same trial was repeated at the end of the block.


Task contingencies
Participants were instructed to learn the underlying state-action-reward association to maximize their rewards. One of the two hidden tasks states s t ∈ {0, 1} would determine the contrast difference on each trial. For instance, if the state of a given trial is 0 (s t = 0), the contrast difference would be negative. That is, the patch on the left side of the fixation dot would have a lower contrast level than the right patch. This relationship is reversed when the trial belongs to s t = 1. Each block is evenly split, with half of the trials in s t = 0 and the other half in s t = 1. The trial's state, in conjunction with the participant's choice (left vs. right patch, referred to as actions a t ∈ {0, 1}), would determine the reward probability. For example, if the participant chose the left patch (a t = 0), which is the lower contrast option in s t = 0, the reward probability would be higher. Similarly, when in state s t = 1 and choosing action a t = 1, which is the lower contrast option, the reward probability would be higher. These blocks are known as the low-contrast blocks. Crucially, in half of the blocks, the state-action-reward contingency was reversed i.e., the other half of the blocks were known as high-contrast blocks where the higher contrast options were more rewarding (s t = 0 and a t = 1 or s t = 1 and a t = 0). Participants were required to relearn the reward contingencies on each block since the contingency could be different from one block to the next due to the randomized presentation of blocks.


Task details
The main task comprised 8 blocks with 20 trials across two conditions: the high-reward uncertainty condition and the low-reward uncertainty condition. In the high-reward uncertainty condition, the reward probability was 70 %, and in the low-reward uncertainty condition, the reward probability was 90 %. Across both conditions and for each trial, the contrast difference between the two patches was randomly sampled from a uniform distribution of [-0.1 to 0] when the trial belonged to s t = 0 and ]0 to 0.1] for trials where s t = 1. Thus, the absolute contrast levels of the patches ranged from 0.40 to 0.60.
During the slider probe phase, the contrast difference was not manipulated across trials, and the patches were clearly distinguishable. To report the estimated reward probabilities on each trial, participants were provided with a slider that ranged from 0 to 100%. To prevent participants from relying solely on the more rewarding option as the hypothetical choice to estimate the state-action-reward relationship, we manipulated the hypothetical choice across task blocks. In half of the blocks, the hypothetical choice during the slider phase was congruent with the more rewarding option in the given block (congruent blocks). However, on the other half of the blocks, the hypothetical choice was incongruent with the more rewarding patch in that block of trials (incongruent blocks). Finally, the order of task blocks was randomized for each participant to avoid any order effects.


Gabor-Bandit task model
To describe our behavioral analysis, we first present a model of the Gabor-Bandit task introducing the key parameters. In line with Bruckner et al. (2020),
• T := 20 stands for the number of trials per block, where we use t to indicate the trial index in all subsequent analyses,
• S ∈ {0, 1} denotes the set of task states, where 0 indicates that the patch on the right has a stronger contrast level than the left patch and vice versa for state 1; the state also determines the action-reward contingency in the task,
• C ∈ [−κ, κ] is the set of contrast differences between the patches, where κ indicates the highest contrast difference,
• A ∈ {0, 1} refers to the set of economic choices, where 0 refers to choosing the left patch, and 1 refers to choosing the right patch,
• R ∈ {0, 1} indicates the set of rewards,
• p ϕ (s t ) is the Bernoulli state distribution defined by
p ϕ (s t ) := B(s t ; ϕ)
(1)
with ϕ := 0.5, which is the probability for each state,
• p(c t |s t ) is the state-conditional contrast-difference distribution defined by the uniform distribution
p κ (c t |s t ) := U (c t ; [−κ, 0]) 1−st U (c t ; ]0, κ]) st (2)
• p at,µ (r t |s t ) is the action-, contingency-parameter, and state-conditional reward distribution. This distribution is defined by
p at,µ (r t |s t ) := B(r t ; µ) 1−st B(r t ; 1 − µ) st 1−at B(r t ; 1 − µ) 1−st B(r t ; µ) st at
(3)
with contingency parameter µ := 0.9 for half of the blocks and µ := 0.1 for the other half under lower reward uncertainty. Similarly, the contingency parameter µ := 0.7 for half of the blocks and µ := 0.3 for the other half under higher reward uncertainty.


Data preprocessing
For our statistical analyses, we relied on participants' single-trial slider responses, from which we derived updates, prediction errors, and learning rates 
(Ganesh et al., 2024)
.
•μ t denotes the subject's slider response, which is the subject's estimate of the contingency parameter µ t in the Gabor-Bandit task. Please note that half of the blocks were congruent (the subject was asked to use the slider to report their estimate of the contingency parameter of the "correct", i.e., the more rewarding option). The other half of the blocks were incongruent (the subject was asked to use the slider to report their estimate of the contingency parameter of the "incorrect", i.e., the less rewarding option). To map the slider responses from both the congruent and incongruent blocks onto a common scale, we re-coded the responses of incongruent blocks according tô
µ t = 1 −μ t
(4)
• Q ∈ {0, 1} indicates a correct (q = 1) and incorrect choice (q = 0), defined by
q =                1, s = 0 ∧ a = 0 ∧ µ > 0.5 1, s = 0 ∧ a = 1 ∧ µ < 0.5 1, s = 1 ∧ a = 1 ∧ µ > 0.5 1, s = 1 ∧ a = 0 ∧ µ < 0.5 0, otherwise
(5)
• D ∈ [−1, 1] stands for the set of prediction errors, defined by
δ t = (r t −μ t ), π 0 ≥ π 1 ((1 −r t ) −μ t ), π 0 < π 1
(6)
wherer t := r t + a t (−1) 2+rt . That is, to compute the prediction error, we take into account the state-action-reward contingency defined in the task model (eq. (3)). For example, when a trial's presented contrast difference favors s t = 0, we assume π 0 > π 1 . Conditional on action a t = 0, the expected reward probability isμ. To account for the action dependency of the reward, we computer t from r t , so that, for example, r t = 0 conditional on a t = 1 corresponds tor t = 1 re-coded for action a t = 0 (where r t = 1 had it been chosen). Similarly, to account for the state dependency of the reward, we rely on (1 −r t ) when state s t = 1 is more likely than s t = 0,
• U ∈ [−1, 1] denotes the set of updates, defined by
u t =μ t −μ t−1
(7)
• B ∈ {0, 1} indicates a choice-confirming outcome (b t = 1) and a choice-disconfirming outcome (b t = 0), defined by
b t =                r t , s = 0 ∧ a = 0 ∧ µ > 0.5 r t , s = 0 ∧ a = 1 ∧ µ < 0.5 r t , s = 1 ∧ a = 1 ∧ µ > 0.5 r t , s = 1 ∧ a = 0 ∧ µ < 0.5 1 − r t , otherwise
(8)
• K ∈ {0, 1} denotes the set of congruence-trial types, where k t = 0 denotes an incongruent and k t = 1 a congruent trial type,
• L ∈ {0, 1} denotes the set of contrast-trial types, where l t = 0 denotes a low-contrast and l t = 1 a high-contrast trial,
• m t represents log-transformed reaction times obtained from the economic choice phase.


Modeling learning behavior
Signed learning-rate analysis To tease apart the factors influencing the single-trial updates, we developed a regression model that allowed us to dissociate multiple factors driving the learning rate 
(Ganesh et al., 2024)
:
u t = β 0 + β 1 • δ t + β 2 • δ t • |c t | + β 3 • δ t • [b t = 1] + β 4 • δ t • [k t = 1] + β 5 • δ t • [l t = 1]
(9)
In this model, β 0 represents the intercept. The β 1 coefficient models the average effect of the prediction error on the update, which we interpret as the fixed learning rate (LR), commonly denoted as α in reinforcement learning. To capture how participants adjusted their learning based on belief states arising from different levels of contrast differences, we included an interaction term between prediction error and absolute contrast difference. We refer to this coefficient β 2 as the belief-state-adapted LR. Next, to control for the effect of the confirmation bias on learning, we use the interaction term β 3 between prediction error and whether an outcome is choice confirming. This is coded as a categorical variable, i.e., 0 for outcomes that disconfirm the choice and 1 for outcomes that confirm the choice. Additionally, we added two task-based block-level categorical variables as control regressors. β 4 was the interaction term between contrast (high vs. low contrast blocks) and prediction error where 0 denoted trials in a low-contrast block and 1 for trials in a high-contrast block, and β 5 captured effects of congruence (congruent vs. incongruent block type) in interaction with prediction error where 0 denoted trials in an incongruent block and 1 for trials in a congruent block. Please note that we did not put any constraints on the range of predicted updates.
Absolute learning-rate analysis Our signed learning-rate approach estimates coefficients that could represent (i) uncertainty-driven calibration of learning or (ii) learning corrupted due to state confusion under uncertainty. We performed an absolute learning-rate analysis approach to tease these two apart and quantify how uncertainty impacts update magnitude. We used absolute prediction errors |δ t | and updates |u t | in conjunction with all the other taskbased regressors mentioned in eq. (9). The coefficients estimated from this analysis reflect the magnitude of belief updates for various factors independent of whether participants updated the slider in the correct or incorrect direction. Next, we used these estimated coefficients to compute our current regression model's predicted absolute updates. We combined single-trial task-based regressor values with the estimated parameters to compute absolute posterior updates p t . Thus, the posterior updates summarize the model-based predictions about learning behavior.
Model properties Across both sets of analyses, all continuous regressors were re-scaled within the range of 0 and 1 by means of the min-max normalization method
x * t = (x t ) − min(X) max(X) − min(X)
(10)
where X is the variable of interest, x t is the value on a given trial that gets normalized, and x * t is the normalized value for a given trial. This was not done for prediction errors, and we used its natural scale since it was key to retain its original sign for the signed LR analyses. We excluded trials where δ t = 0 since these trials do not necessitate belief updates. Moreover, using a canonical linear regression model is based on the assumption that the residuals are homoscedastic, that is, similar across the range of the predictor variable. However, in our model, the assumption of homoscedasticity is violated, particularly for larger prediction errors. Thus, we accounted for heteroscedasticity by using a weighted regression model, wherein more weight is given to the observations with smaller residuals providing more reliable information.


Regression diagnostics
We computed a partial-R 2 to capture the extent to which our signed and absolute behavioral regression models explain learning behavior relative to a baseline model with no task-based predictors. To do so, we used the following approach partial-R 2 = SSE baseline − SSE behv SSE baseline 
11
where SSE behv is the sum of squared errors of our signed or absolute behavioral regression model and SSE baseline is the sum of squared errors of a baseline regression model with an intercept and excluding all other predictors.


Pupillometry
Pupil diameter along with horizontal and vertical eye position was measured from the left eye using an EyeLink 1000 plus desktop mount eye-tracker (SR Research, Ontario, Canada) at a sampling rate of 1000 Hz while participants performed the behavioral task in a dark room. Participants were instructed to place their heads on a chin rest during the task. The distance between the screen and the chin rest was kept constant at 60 cm. Calibration and validation procedures were performed before the start of the task. A calibration was accepted only if the eye tracker recognized it as "stable". After the calibration procedure was completed, we performed validation. If the deviation between the actual and predicted gaze location based on calibration was more than 4 mm of visual angle, then the eye-tracker was re-calibrated. The procedures were repeated between blocks if the participants moved their heads away from the chinrest. A nine-point calibration grid was used wherein each calibration target was a circle that was black in color (#000000).
Preprocessing We preprocessed the raw pupil signal for all further analyses using a custom Matlab preprocessing pipeline. First, blinks that resulted in missing pupil data were identified automatically by the in-built EyeLink software. A time window of 150 ms was used to add padding before and after the blink on which linear interpolation was applied. We also used peak detection on the velocity of the pupil signal to find additional blinks which were also linearly interpolated 
(Urai et al., 2017)
. Pupil data were then band-pass filtered using a third-order Butterworth filter with a pass band of (0.01, 10 Hz) 
(Knapen et al., 2016)
. Low-pass filtering removes measurement noise from the signal. High-pass filtering removes meaningful slow drift from the signal. To do so, we applied a low-pass filter, and the filter coefficients acted as the inputs to the band-pass filter. Moreover, we applied a high-pass filter, and the band-pass filter itself was run over to the high-pass-filtered data. These steps were based on the in-built Matlab butter and filtfilt functions. Next, to get rid of dips in the pupil signal that typically follow a blink or a saccade, we used the filtered pupil signal to first estimate the response to blinks and saccades using deconvolution. Once these responses were identified, they were regressed out of the pupil signal 
(Knapen et al., 2016)
. Finally, the slow drift obtained from the low-pass-filtered signal was added back to the cleaned pupil signal. The pupil signal was then z-scored for each participant and down-sampled to 100 Hz.


Pupil data analysis
Quantifying feedback-related pupil dilation To examine our questions specific to the influence of state uncertainty on arousal levels during learning, we first obtained pupil dilation for each trial after the feedback presentation. For this purpose, we relied on the pupil diameter on each trial after the onset of feedback until the end of the trial. Next, we baseline-corrected it by subtracting the mean pupil diameter for 300 ms before the event onset to obtain each trial's feedback-related phasic pupil dilation. For all model-based analyses, we used the computed single-trial pupil dilation.
Modeling feedback-related pupil dilation To examine the relationship between task-based and single-trial behavioral parameters and baseline corrected pupil response to feedback onset, we applied the following regression model to single-trial feedback-related pupil dilation for each time point:
Pupil = β 0 + β 1 • |δ t | + β 2 • |δ t | • |c t | + β 3 • |c t | + β 4 • m t + β 5 • |u t | + β 6 • x t + β 7 • y t
(12)
β 0 is the intercept. β 1 is the coefficient that reflects the main effect of absolute singletrial prediction errors on pupil dilation. We refer to this as the prediction-error-modulated pupil coefficient as it models the impact of prediction error magnitude on pupil dilation. β 2 is the coefficient that captures the interaction effect between absolute prediction errors and contrast-difference levels. This regressor approximates the changes in pupil dilation for different levels of state uncertainty for a given prediction error. We refer to this as the belief-stateweighted prediction error coefficient. Next, to check if state uncertainty had a direct influence on pupil dilation, we added the main effect of contrast difference as a regressor (β 3 ). Next, we added the following nuisance variables as control regressors. β 4 captures variance explained by reaction time. We also added absolute single-trial belief updates as a regressor (β 5 ) to control for variance in pupil dilation due to larger slider responses and its collinear relationship with absolute prediction errors. Next, to control for any fluctuations in pupil dilation resulting from changes in horizontal (x t ) and vertical (y t ) eye position, we added regressors β 6 and β 7 , respectively. All variables were z-scored separately for each participant.
Binned regression approach To examine if state uncertainty impacts how much prediction errors regulate pupil dilation, we used a binned regression approach. Based on median splitting, we create two separate bins of trials with high and low contrast-difference levels for each participant. Next, we fitted the following model separately to explain the pupil dilation within each bin in a sample-by-sample fashion. Please note that this model is a reduced version of eq. (12) as we excluded contrast-difference-related regressors. All other nuisance regressors were included as control variables and normalized by z-scoring for each participant:
Pupil = β 0 + β 1 • |δ t | + β 2 • m t + β 3 • |u t | + β 4 • x t + β 5 • y t
(13)
The binned regression approach results in two sets of β 1 coefficients, which reflect the extent to which absolute prediction errors impact pupil dilation in low and high contrast-difference trials.
Arousal-based analysis of behavioral residuals In order to test if and how fluctuations in pupil-linked arousal relate to belief updates beyond our behavioral model, we fit the following model to absolute single-trial belief updates:
|μ t | = β 0 + β 1 • |p t | + β 2 • |Pupil| + β 3 • |c t | • |Pupil| + β 4 • |Pupil| • |δ t | + β 5 • |Pupil| • |δ t | • |c t |
(14)
Cluster-corrected permutation testing Our regression analysis, binned regression analysis and residual learning analysis resulted in coefficients estimated for each time point in the feedback time window. Thus, we used a cluster-corrected permutation-test approach for significance testing to account for multiple comparisons over time. We relied on the ft timelockstatistics function by FieldTrip 
(Oostenveld et al., 2011)
. First, we calculated the original test statistic (t-value) for the data by comparing the conditions of interest in the case of a two-tailed test or one set of values to zero for a one-tailed test. To perform clustering, we grouped adjacent data points that exceeded a predefined threshold based on the test statistic. Next, the condition labels of the data were randomly shuffled between the two groups for the two-tailed test. Alternatively, we used a sign-flipping procedure which involves randomly changing the signs (positive or negative) of the data when comparing data from one condition to zero. The test statistic (t-value) was then calculated for the permuted dataset, and we repeated this procedure 1000 times to create a null distribution. Finally, the original test statistic was compared to this null distribution, and the p-value indicates the proportion of permuted statistics that are greater than the original statistic.
Binned regression analysis 
Figure S2
. Binned regression approach. Regression coefficients explaining feedback-locked pupil dilation, estimated for two bins of low and high state uncertainty trials for a| update magnitude, b| reaction times, c| gaze position on the x-axis, d| gaze position on the y-axis. The gray line indicates p-values from a cluster-based permutation test of the difference between two conditions. 
Figure S3
. Absolute prediction errors for levels of state uncertainty Mean ± standard error of the mean (SEM) absolute prediction errors for high and low levels of state uncertainty. There was no significant difference between the mean absolute prediction errors computed for trials with high state uncertainty as compared to low levels of state uncertainty.
Additional regression coefficients arousal analysis 
Figure S5
. Model-fit assessment. a| A visual representation of the goodness of fit, as illustrated by the modelpredicted posterior absolute updates using estimated parameters and single-trial regression data. b| Partial-r 2 values show the regression model was moderately effective in capturing and explaining learning data as compared to a baseline model, despite heterogeneity across participants.
To systematically compare the regression results to the empirical data, we computed the modelpredicted posterior updates. Model-based updates captured the general trend in participants' learning behavior 
(Fig. S5a
). One key difference is that empirical updates included a higher frequency of extremely small perservative updates as compared to the model (around 0 as indicated by the blue bar in 
Fig. S5a
). Finally, we examined the regression model's goodness of fit using partial-r 2 , which quantifies the amount of variance captured by our behavioral regression model as compared to a baseline model with no task-based predictors ( 
Fig. S5b
; see regression diagnostics for more details on the same). 
Figure S6
. Contribution of arousal-related regressors in explaining belief updating beyond our behavioral model. a| The impact of trial-by-trial fluctuations in pupil-linked arousal to explaining residual learning was significantly modulated by the level of state uncertainty. This could suggest that pupil-linked arousal fluctuations are more crucial to explaining variance in learning behavior specifically under higher state uncertainty. b| Model-predicted absolute updates across bins of high and low state uncertainty. Higher state uncertainty (i.e., on average, smaller contrast differences) led to larger belief updates, for higher levels of pupil-linked arousal, as compared to trials with larger contrast differences. Moreover, the impact of trial-by-trial fluctuations in pupillinked arousal to explaining residual learning was not significantly modulated by c| absolute prediction errors and d| and its interaction with the level of state uncertainty. The gray line indicates p-values from a cluster-based permutation test of the difference between each time course and zero.


Control regression analysis
Our main analysis approach based on eq. (12) applies the regression model to baseline-corrected pupil dilation post-feedback onset. However, to ensure that our results hold across different regression approaches, we applied two alternative control models. In the first model, pupil baseline was a regressor in the model and not removed from the signal before the analysis. In the second model, we additionally removed reaction-time components before applying the regression model. In both cases, the results were similar to our main analysis.


Baseline as a regressor
To assess the phasic pupil response independent of baseline arousal level 
(Gilzenrat et al., 2010;
He et al., 2020;
Murphy et al., 2011)
, we applied the following control regression model to single-trial, feedback-related and non-baseline corrected pupil diameter for each time point.
Pupil = β 0 + β 1 • |δ t | + β 2 • |δ t | • |c t | + β 3 • |c t | + β 4 • baseline t + β 5 • m t + β 6 • |u t | + β 7 • x t + β 8 • y t
(15)
Since the model is being fit to a non-baseline corrected measure of pupil-linked arousal, we added the mean of the pupil diameter during the baseline period (i.e., 300 ms before feedback onset) as a regressor. Thus, β 4 accounts for the impact of baseline arousal on the pupil diameter. The beta coefficients estimated from our control model aligned with the main findings. The positive main effect of absolute prediction errors and the interaction effect between prediction errors and state uncertainty qualitatively resemble the effects from our main analysis ( 
Fig. 4a  and b
) and are significantly different from zero (see PE-modulated pupil, p = 0.002 in 
Fig. S5b  and c
). 
Figure S7
. Control regression model with baseline as regressor. We applied a control regression model to explain non-baseline corrected pupil response at each time point in the feedback phase. To account for the impact of baseline arousal on pupil response, we added the main effect of baseline response as a regressor in the model. Model-estimated parameters for a| the level of state uncertainty, b| absolute prediction errors, c| interaction between state uncertainty and prediction errors, d| baseline pupil response, e| absolute updates, f| reaction-times, g| x-gaze position and h| y-gaze position.


Removing reaction-time components prior to analysis
We also controlled for trial-by-trial variations in the amplitude of the pupil responses caused by differences in reaction times across trials 
(Hoeks & Ellenbroek, 1993;
Urai et al., 2017)
. In particular, before estimating the parameters of the regression model, we regressed out components explained by reaction time.
Pupil' = Pupil − (Pupil T • m t ) • m t
(16)
where "Pupil" is the original vector of pupil responses, m t is the vector of the corresponding single-trial reaction times (log-transformed and normalized to a unit vector), and T denotes matrix transpose. We then fitted our regression model from eq. (12) to the residuals (Pupil'), which reflected pupil responses after removing components explained by single-trial reaction times. Please note that although eq. (16) accounts for the impact of reaction time on the response amplitude, we also accounted for single-trial reaction times within the regression as before.
The beta coefficients estimated from this control model were again in alignment with our main findings. The positive main effect of absolute prediction errors and the interaction effect between prediction errors and state uncertainty are comparable to the effects from our main analysis ( 
Fig. 4a and b
) and are significantly different from zero (see PE-modulated pupil, p < 0.001 and BS-weighted PE, p = 0.02 in 
Fig. S6b and c)
. 
Figure S8
. Control model with RT regressed. We applied a control regression model to baseline-corrected pupil response after removing the impact of reaction times at each time point in the feedback phase. Modelestimated parameters for a| the level of state uncertainty, b| absolute prediction errors, c| interaction between state uncertainty and prediction errors, d| absolute updates, e| reaction times, f| x-gaze position and g| y-gaze position. 
Figure S9
. Influence of task-based and control regressors on pupil dilation post patch. We applied a regression model to explain baseline-corrected pupil response at each time point in the patch phase. Modelestimated parameters for a| x-gaze position, b| y-gaze position, c| contrast differences (reflecting state uncertainty), and d| low reward uncertainty. 
Figure S10
. Single-subject average (black curve) and single-trial (gray curves) pupil response after feedback onset
Figure 1 .
1
Arousal influences learning under perceptual uncertainty.


Figure 2
2
Figure 2. Experimental task and learning behavior. a| Uncertainty-augmented Gabor-Bandit task. Participants were instructed that the aim of the task was to maximize rewards. A pair of Gabor patches with varying contrast differences was presented on each trial. Participants made an economic choice between the patches (choosing the high-or low-contrast patch). After each choice and a jittered delay, auditory reward feedback was presented. Finally, participants reported their estimate of the reward probability (for a hypothetical choice) by using a slider between 0 (low reward probability) and 100 percent (high reward probability). Inset plot. We used two experimental conditions. The two conditions differed in terms of reward uncertainty. In half of the blocks, reward uncertainty was low, and when the "correct" patch was chosen, the reward probability was 90%. In contrast, reward uncertainty was higher in the other half of the blocks (70% reward probability for a correct choice). b| Task contingency. To maximize rewards, participants were required to learn the underlying state-action-reward contingency for each block of trials. Each trial could belong to either state 0 or 1. In state 0, the patch on the right had a higher contrast level, and vice versa in state 1. Conditional on the state, the exact contrast difference was sampled from a uniform distribution ranging from low difference values that were virtually in-discriminable (higher uncertainty) to higher values (lower uncertainty). The contingency parameter determines the probability of a reward for a given state-action combination. In this example, the reward probability is higher on choosing the left patch in state 0. Similarly, the reward probability is higher on choosing the right patch in state 1. Thus, to learn this underlying relationship, participants need to use the obtained reward to estimate the probability with which a given action is likely to be rewarded conditional on the current trial's state. Participants face a considerable amount of uncertainty in trials with smaller contrast differences making state inference challenging.








the Länder. C.F. was funded by the DFG, grant numbers FI 2309/1-1 and FI 2309/2-1. R.B. is supported by DFG grants BR 6959/2-1 and GL 984/3-1.






Data and code sharing
All code and processed data required to reproduce our analyses and figures are available at https://github.com/prashantig25/Perceptual unc aug task pupil.
The authors declare no competing interests.
The authors declare no competing interests.


Supplementary material
Economic choice performance 
Figure S1
. Choice behavior. Mean ± standard error of the mean (SEM) economic performance, defined as the frequency of choosing the more rewarding or correct option across the two experimental conditions.
The average economic choice performance was above chance in both conditions (high reward uncertainty: mean = 0.72 ± 0.022, t 45 = 9.89, p < 0.001, Cohen's d = 4.84, low reward uncertainty: mean = 0.76 ± 0.017, t 45 = 15.26, p < 0.001, Cohen's d = 6.58). 
Figure S4
. Influence of additional task-based and control regressors on pupil dilation post feedback. Model-estimated coefficients for each time point, explaining the impact of the main effect of a| contrast difference (reflecting state uncertainty), b| update magnitude, c| reaction times, d| gaze position on x-axis, and e| gaze position on y-axis on feedback-locked pupil response. The gray line indicates p-values from a cluster-based permutation test of the difference between each time course and zero.


Additional regression coefficients main analysis
 










An integrative theory of locus coeruleus-norepinephrine28 function: Adaptive gain and optimal performance




G
Aston-Jones






J
D
Cohen




10.1146/annurev.neuro.28.061604.135709








Annual Review of Neuroscience




28


1
















Belief state representation in the dopamine system




B
M
Babayan






N
Uchida






S
J
Gershman




10.1038/s41467-018-04397-0








Nature Communications




9


1


1891














Modulation of visual cortical plasticity by acetylcholine and noradrenaline




M
F
Bear






W
Singer




10.1038/320172a0








Nature




320


6058
















The locus coeruleus-noradrenergic system: Modulation of behavioral state and state-dependent cognitive processes




C
W
Berridge






B
D
Waterhouse




10.1016/S0165-0173(03)00143-7








Brain Research Reviews




42


1
















Anxious individuals have difficulty learning the causal statistics of aversive environments




M
Browning






T
E
Behrens






G
Jocham






J
X
O'reilly






S
J
Bishop




10.1038/nn.3961








Nature Neuroscience




18


4
















Belief states and categorical-choice biases determine reward-based learning under perceptual uncertainty




R
Bruckner






H
R
Heekeren






D
Ostwald




10.1101/2020.09.18.303495


















Phasic activation of dorsal raphe serotonergic neurons increases pupil size




F
Cazettes






D
Reato






J
P
Morais






A
Renart






Z
F
Mainen




10.1016/j.cub.2020.09.090








Current Biology




31


1
















Reinforcement learning with perceptual aliasing: The perceptual distinctions approach




L
Chrisman








AAAI Press














Task-evoked pupil responses reflect internal belief states




O
Colizoli






J
W
De Gee






A
E
Urai






T
H
Donner




10.1038/s41598-018-31985-3








Scientific Reports




8


1


13702














The algorithmic anatomy of model-based evaluation




N
D
Daw






P
Dayan




10.1098/rstb.2013.0478








Philosophical Transactions of the Royal Society B: Biological Sciences




369














Decision theory, reinforcement learning, and the brain




P
Dayan






N
D
Daw




10.3758/CABN.8.4.429








Affective, & Behavioral Neuroscience




8


4










Cognitive








Phasic norepinephrine: A neural interrupt signal for unexpected events




P
Dayan






A
J
Yu




10.1080/09548980601004024








Network: Computation in Neural Systems




17


4
















Computations of uncertainty mediate acute stress responses in humans




A
O
De Berker






R
B
Rutledge






C
Mathys






L
Marshall






G
F
Cross






R
J
Dolan






S
Bestmann




10.1038/ncomms10996








Nature Communications




7


1


10996














Dynamic modulation of decision biases by brainstem arousal systems. eLife, 6, e23232




J
W
De Gee






O
Colizoli






N
A
Kloosterman






T
Knapen






S
Nieuwenhuis






T
H
Donner




10.7554/eLife.23232


















Decision-related pupil dilation reflects upcoming choice and individual bias




J
W
De Gee






T
Knapen






T
H
Donner




10.1073/pnas.1317557111








Proceedings of the National Academy of Sciences




5


111














Efficient stabilization of imprecise statistical inference through conditional belief updating




J
Drevet






J
Drugowitsch






V
Wyart




10.1038/s41562-022-01445-0








Nature Human Behaviour




6


12
















Reinforcement learning under uncertainty: Expected versus unexpected uncertainty and state versus reward uncertainty




A
Ez-Zizi






S
Farrell






D
Leslie






G
Malhotra






C
J
Ludwig




10.1007/s42113-022-00165-y








Computational Brain & Behavior




6


4
















Adaptive integration of perceptual and reward information in an uncertain world. eLife, 13




P
Ganesh






R
M
Cichy






N
W
Schuck






C
Finke






R
Bruckner




10.7554/eLife.99266.1


















Believing in dopamine




S
J
Gershman






N
Uchida




10.1038/s41583-019-0220-7








Nature Reviews Neuroscience




20


11
















Pupil diameter tracks changes in control state predicted by the adaptive gain theory of locus coeruleus function




M
S
Gilzenrat






S
Nieuwenhuis






M
Jepma






J
D
Cohen






















Affective
Cognitive






Behavioral Neuroscience




10.3758/CABN.10.2.252






10














Age-related changes in the functional integrity of the phasic alerting system: A pupillometric investigation




M
He






W
C
Heindel






M
R
Nassar






E
M
Siefert






E
K
Festa




10.1016/j.neurobiolaging.2020.02.025








Neurobiology of Aging




91
















A neural basis for a quantitative pupillary model




B
Hoeks






B
Ellenbroek








Journal of Psychophysiology




7
















Pupil size as a window on neural substrates of cognition




S
Joshi






J
I
Gold




10.1016/j.tics.2020.03.005








Trends in Cognitive Sciences




24


6
















Relationships between pupil diameter and neuronal activity in the locus coeruleus, colliculi, and cingulate cortex




S
Joshi






Y
Li






R
M
Kalwani






J
I
Gold




10.1016/j.neuron.2015.11.028








Neuron




89


1
















Cognitive and ocular factors jointly determine pupil responses under equiluminance




T
Knapen






J
W
De Gee






J
Brascamp






S
Nuiten






S
Hoppenbrouwers






J
Theeuwes




10.1371/journal.pone.0155574








PLoS ONE


T. Verguts




11


5














Arousal-related adjustments of perceptual biases optimize perception in dynamic environments




K
Krishnamurthy






M
R
Nassar






S
Sarode






J
I
Gold




10.1038/s41562-017-0107








Nature Human Behaviour




1


6


107














Midbrain dopamine neurons signal belief in choice accuracy during a perceptual decision




A
Lak






K
Nomoto






M
Keramati






M
Sakagami






A
Kepecs




10.1016/j.cub.2017.02.026








Current Biology




27


6
















Dopaminergic and prefrontal basis of learning from sensory confidence and reward value




A
Lak






M
Okun






M
M
Moss






H
Gurnani






K
Farrell






M
J
Wells






C
B
Reddy






A
Kepecs






K
D
Harris






M
Carandini




10.1016/j.neuron.2019.11.018








Neuron




105


4
















Posterior weighted reinforcement learning with state uncertainty




T
Larsen






D
S
Leslie






E
J
Collins






R
Bogacz




10.1162/neco.2010.01-09-948








Neural Computation




22


5
















Neural coding of uncertainty and probability




W
J
Ma






M
Jazayeri




10.1146/annurev-neuro-071013-014017








Annual Review of Neuroscience




37


1
















Reduced pupillary reward sensitivity in parkinson's disease




S
G
Manohar






M
Husain




10.1038/npjparkd.2015.26








Parkinson's Disease




1


1


15026














Neuroplasticity regulation by noradrenaline in mammalian brain




A
Marzo






J
Bai






S
Otani




10.2174/157015909790031193








Current Neuropharmacology




7


4
















Waking state: Rapid variations modulate neural and behavioral responses




M
J
Mcginley






M
Vinck






J
Reimer






R
Batista-Brito






E
Zagha






C
R
Cadwell






A
S
Tolias






J
A
Cardin






D
A
Mccormick




10.1016/j.neuron.2015.09.012








Neuron




87


6
















Pupil diameter is not an accurate real-time readout of locus coeruleus activity. eLife, 11, 70510




M
Megemont






J
Mcburney-Lin






H
Yang




10.7554/eLife.70510


















Pupil diameter covaries with BOLD activity in human locus coeruleus




P
R
Murphy






R
G
O'connell






M
O'sullivan






I
H
Robertson






J
H
Balsters




10.1002/hbm.22466








Human Brain Mapping




35


8
















Pupillometry and p3 index the locus coeruleus-noradrenergic arousal function in humans




P
R
Murphy






I
H
Robertson






J
H
Balsters






R
G
O'connell




10.1111/j.1469-8986.2011.01226.x








Psychophysiology




48


11
















Neuromodulation of neurons and synapses




F
Nadim






D
Bucher




10.1016/j.conb.2014.05.003








Current Opinion in Neurobiology




29
















Statistical context dictates the relationship between feedback-related EEG signals and learning. eLife, 8, 46975




M
R
Nassar






R
Bruckner






M
J
Frank




10.7554/eLife.46975


















Dissociable forms of uncertaintydriven representational change across the human brain




M
R
Nassar






J
T
Mcguire






H
Ritz






J
Kable




10.1523/JNEUROSCI.1713-18.2018








The Journal of Neuroscience


















Rational regulation of learning dynamics by pupil-linked arousal systems




M
R
Nassar






K
M
Rumsey






R
C
Wilson






K
Parikh






B
Heasly






J
I
Gold




10.1038/nn.3130








Nature Neuroscience




15


7
















FieldTrip: Open source software for advanced analysis of MEG, EEG, and invasive electrophysiological data




R
Oostenveld






P
Fries






E
Maris






J.-M
Schoffelen




10.1155/2011/156869








Computational Intelligence and Neuroscience


















Dissociable effects of surprise and model update in parietal and anterior cingulate cortex




J
X
O'reilly






U
Schüffelgen






S
F
Cuell






T
E J
Behrens






R
B
Mars






M
F S
Rushworth




10.1073/pnas.1305373110








Proceedings of the National Academy of Sciences




38


110














Coupling of pupil-and neuronal population dynamics reveals diverse influences of arousal on cortical processing. eLife, 11, e71890




T
Pfeffer






C
Keitel






D
S
Kluger






A
Keitel






A
Russmann






G
Thut






T
H
Donner






J
Gross




10.7554/eLife.71890


















Spectral signature and behavioral consequence of spontaneous shifts of pupil-linked arousal in human. eLife, 10, e68265




E
Podvalny






L
E
King






B
J
He




10.7554/eLife.68265


















Pupil dilation signals surprise: Evidence for noradrenaline's role in decision making




K
Preuschoff




10.3389/fnins.2011.00115








Frontiers in Neuroscience
















Designing to support adaptation




J
Rasmussen




10.1177/154193120004402215








Proceedings of the Human Factors and Ergonomics Society Annual Meeting


the Human Factors and Ergonomics Society Annual Meeting






44














Pupil fluctuations track rapid changes in adrenergic and cholinergic activity in cortex




J
Reimer






M
J
Mcginley






Y
Liu






C
Rodenkirch






Q
Wang






D
A
Mccormick






A
S
Tolias




10.1038/ncomms13289








Nature Communications




7


1


13289














A cellular mechanism of reward-related learning




J
N J
Reynolds






B
I
Hyland






J
R
Wickens




10.1038/35092560








Nature




6851
















Dopamine-dependent plasticity of corticostriatal synapses




J
N
Reynolds






J
R
Wickens




10.1016/S0893-6080(02)00045-X








Neural Networks




15


4


45














Learning by neurones: Role of attention, reinforcement and behaviour




S
J
Sara




10.1016/S0764-4469(97)89821-6








Comptes Rendus de l'Académie des Sciences -Series III -Sciences de la Vie






321














Human orbitofrontal cortex represents a cognitive map of state space




N
W
Schuck






M
B
Cai






R
C
Wilson






Y
Niv




10.1016/j.neuron.2016.08.019








Neuron




6
















Dopamine reward prediction errors reflect hidden-state inference across time




C
K
Starkweather






B
M
Babayan






N
Uchida






S
J
Gershman




10.1038/nn.4520








Nature Neuroscience




20


4
















Building bridges between perceptual and economic decision-making: Neural and computational mechanisms




C
Summerfield






K
Tsetsos




10.3389/fnins.2012.00070








Frontiers in Neuroscience




6














Pupil-linked arousal is driven by decision uncertainty and alters serial choice bias




A
E
Urai






A
Braun






T
H
Donner




10.1038/ncomms14637








Nature Communications




8


1


14637














Brainstem modulation of largescale intrinsic cortical activity correlations




R
L
Van Den Brink






T
Pfeffer






T
H
Donner




10.3389/fnhum.2019.00340








Frontiers in Human Neuroscience




13


340














Pupil dilation as an index of effort in cognitive control tasks: A review




P
Van Der Wel






H
Van Steenbergen




10.3758/s13423-018-1432-y








Psychonomic Bulletin & Review




25


6
















How pupil responses track value-based decision-making during and after reinforcement learning




J
C
Van Slooten






S
Jahfari






T
Knapen






J
Theeuwes




10.1371/journal.pcbi.1006632








PLOS Computational Biology


W. Einhäuser




14


11


1006632














The antidepressant fluoxetine restores plasticity in the adult visual cortex




J
F M
Vetencourt






A
Sale






A
Viegi






L
Baroncelli






R
De Pasquale






F
O'leary






O
Castrén






E
Maffei






L




10.1126/science.1150516








Science




320


5874
















Controlling low-level image properties: The SHINE toolbox




V
Willenbockel






J
Sadr






D
Fiset






G
O
Horne






F
Gosselin






J
W
Tanaka




10.3758/BRM.42.3.671








Behavior Research Methods




42


3
















Orbitofrontal cortex as a cognitive map of task space




R
C
Wilson






Y
K
Takahashi






G
Schoenbaum






Y
Niv




10.1016/j.neuron.2013.11.005








Neuron




81


2
















Uncertainty, neuromodulation, and attention




A
J
Yu






P
Dayan




10.1016/j.neuron.2005.04.026








Neuron




46


4
















Adaptive learning is structure learning in time




L
Q
Yu






R
C
Wilson






M
R
Nassar




10.1016/j.neubiorev.2021.06.024








Neuroscience & Biobehavioral Reviews




128

















"""

Output: Provide your response as a JSON list in the following format:

[
  {
    "topic_or_construct": "...",
    "measured_by": "...",
    "justification": "..."
  },
  ...
]