You are an expert in psychology and computational knowledge representation. Your task is to extract key scientific information from psychology research articles to build a structured knowledge graph.

The knowledge graph aims to represent the relationships between psychological **topics or constructs** and their associated **measurement instruments or scales**. Specifically, for each article, extract information in the form of triples that capture:

1) The psychological topic or construct being studied
2) The measurement instrument or scale used to assess it
3) A brief justification (1–3 sentences) from the article text supporting this measurement link

Guidelines:
- Extract meaningful **phrases** (not full sentences or vague descriptions) for both `topic_or_construct` and `measured_by`, suitable for inclusion in a knowledge graph.
- Include a short justification for each extraction that clearly supports the connection.
- If the article does not discuss psychological constructs and how they are measured (e.g., no mention of constructs, instruments, or scales), return an empty list `[]`.

Input Paper:
"""



Mental fatigue is associated with reduced effort on demanding cognitive operations. Consequently, task performance and work efficiency tend to decline under mental fatigue 
(Boksem et al., 2005
(Boksem et al., , 2006
Hopstaken et al., 2015;
Hopstaken et al., 2016)
. The adverse consequences of mental fatigue have been documented in a variety of settings. In an office work environment, for example, mental fatigue has been observed to reduce both typewriting speed and accuracy 
(de Jong et al., 2020)
. In transportation, mental fatigue among drivers has been considered as a major cause of road accidents 
(Lal & Craig, 2001)
. It has been estimated that 20% ∼ 30% of all road accidents and 5% ∼ 15% of fatal road accidents involve fatigue 
(Razmpa et al., 2011)
. In healthcare, more than 78% of health providers including physicians and nurses have reported experiencing fatigue-related burnout, which has been identified as "a public health crisis that urgently demands action" 
(Jha et al., 2019)
.
Although mental fatigue has been studied formally for over 100 years, and its adverse consequences have been observed for even longer 
(Thorndike, 1900)
, its origin and effects are still a matter of debate 
(Massar et al., 2018;
Pattyn et al., 2018)
. In this manuscript we propose a mathematical framework for modeling and estimating the effects of mental fatigue on the allocation of mental effort. The guiding assumption in this approach is that humans are rational in deciding to exert mental effort in the sense that they aim to maximize subjective values 
(Loewenstein et al., 2008;
Shenhav et al., 2013;
Westbrook & Braver, 2015)
. Simply put, when the rewards for successful task performance exceed the perceived costs, people are inclined to put effort into the task. Otherwise, the task may be abandoned in favor of other more valued activities. We assume that mental fatigue impacts the subjective value of effort expenditure, and we report a mathematical model rooted in this perspective that may help to estimate and explain effects of mental fatigue.


Mental effort
Many cognitive activities are habitual and can be executed quickly and easily, but some mental operations-especially those involving cognitive control-are slower and more effortful and thus may be construed as costly. For example, encoding a single-digit number and recalling it a few moments later is a simple cognitive operation that even young children, who lack fully developed cognitive capacities, can accomplish with relative ease. By contrast, encoding a five-digit number while processing a dense passage of text and then recalling the number minutes later is a more effortful mental operation. Juggling multiple streams of information requires cognitive control to maintain the target information (i.e., the number) in working memory and to prevent it from being dislodged by competing information 
(Engle, 2010;
Unsworth & Engle, 2007)
. But what currency is used to pay for costly mental effort?
The costs of cognitive operations have at least two origins, namely intrinsic costs and opportunity costs. Intrinsic costs stem from the limited nature of cognitive capacity: only so much information can be processed at any given time. Such intrinsic costs may derive from limited metabolic resources or finite task-relevant information storage capacity 
(Shenhav et al., 2017)
. Indeed, one stream of thought has suggested that suboptimal behaviors are deeply rooted in the finite nature of the brain's computational capacity 
(Gershman et al., 2015;
Griffiths et al., 2015)
. Opportunity costs arise insofar as more than one task is available to perform. Exerting mental effort on one task comes at the price of foregoing other tasks and the rewards associated with them. Most relevant to this manuscript is the assumption that the way people allocate mental effort reflects their subjective preferences and optimality principles 
(Lieder et al., 2012;
Vul et al., 2014)
.
The limits of cognitive capacity -whether due to intrinsic costs or opportunity costs -call for deliberate allocation of mental effort. Numerous experiments have observed that individuals adjust the level of effort they allocate to cognitive tasks according to the perceived trade-offs between taskassociated costs and rewards. For example, when allowed to choose among different tasks to perform, participants avoided more cognitively demanding tasks in favor of less demanding tasks 
(Kool et al., 2010)
. Another study used an economic discounting paradigm to study subjective costs associated with different tasks 
(Westbrook et al., 2013)
. Participants were instructed to choose among a set of tasks associated with different difficulty levels and different rewards. The rewards required for choosing to perform highly demanding tasks were substantially higher than those for simpler tasks. These results revealed a reluctance to exert effort when available rewards for successful task performance fall below a subjective breakeven point.


The subjective value of effort expenditure
The difference between the perceived costs and rewards for performing a task can be construed as stemming from subjective value 
(Westbrook & Braver, 2015)
. Building upon the concept of subjective value, a normative model can be formulated to translate a person's behaviors into subjective preferences 
(and vice versa)
. Moreover, the model parameters can, in some cases, be estimated from behavioral data 
(Chong et al., 2017;
Hartmann et al., 2013;
Klein-Flügge et al., 2015;
Prévost et al., 2010)
. For example, one investigation attempted to fit linear, hyperbolic, parabolic, and exponential subjective value functions to participants' choices to allocate mental and physical effort by using a maximum likelihood estimation procedure 
(Chong et al., 2017)
. This work yielded different models for mental (hyperbolic) versus physical effort (parabolic), a conclusion further corroborated by evidence for both domain-general and domain-specific neural substrates for coding the two types of effort.
An important strand in the literature on modeling mental exertion by subjective values relates to the expected value of control (EVC) model 
(Shenhav et al., 2013;
Shenhav et al., 2017)
, which construes the subjective value of effortful cognitive control as the sum of the value of the present state of the world and the expected future value that results from the current effort expenditures. According to the EVC model, the allocation of mental effort reflects a rational decision process whereby effort is adjusted over time to maximize subjective value. The EVC model extended a value-based decision making account by considering the consequences of current cognitive effort exertion on distal subjective values 
(Chong et al., 2017;
Hartmann et al., 2013;
Klein-Flügge et al., 2015;
Prévost et al., 2010
) .
The EVC model has been tested and validated in a handful of prior studies. For example, one study built an EVC model using a simulated flanker task 
(Musslick et al., 2015)
. This study validated classic findings in a sample of simulated subjects, including reduced error rates and slower reactions after erroneous responses 
(Laming, 1968)
, as well increased intensity of mental effort with increased incentives for task performance 
(Padmala & Pessoa, 2010)
. The EVC model also has provided a useful framework for studying the plasticity of control 
(Lieder et al., 2018)
 and the influence of affect on cognitive control 
(Grahek et al., 2020)
.
However, some basic components of the EVC model are not directly observable and thus are hard to identify. For example, the value of the outcomes and the costs of cognitive control cannot be directly observed and thus the EVC model might be mis-specified, which limits the capability of the EVC model to explain empirical data. Hence, to validate the EVC framework, those model components have to be correctly identified. Although some past work has been done to obtain those basic components from experimental data 
(Musslick et al., 2018)
, there is still far from enough discussion on how best to identify otherwise unknown model primitives. Nevertheless, the EVC model, as we shall propose below, can be extended to incorporate and identify the effects of mental fatigue.


Effects of mental fatigue on cognitive control
There is no gold standard definition of mental fatigue 
(Massar et al., 2018;
Pattyn et al., 2018)
. As mentioned previously, both common experience and empirical studies have revealed that mental fatigue is accompanied by aversion to effort expenditure, poorer task performance, and subjective feelings of tiredness 
(Boksem et al., 2005;
Dittner et al., 2004;
Hopstaken et al., 2015;
Hopstaken et al., 2016;
Pattyn et al., 2018)
. A prevailing metaphor for mental fatigue, similar to physical fatigue, is that it is induced by the depletion of energetic resources. The energetic resource has been hypothesized to be glucose in the bloodstream, which is essential for virtually all bodily (including brain) functions 
(Fairclough & Houston, 2004;
. The idea is that the resource (e.g., glucose) gets used up by performing effortful mental tasks, leaving the person relatively less able to continue to exert effort until the resource has been restored. However, the resource metaphor has been challenged both conceptually and empirically. Whereas some studies found evidence that blood glucose decreases after cognitively demanding tasks 
(Fairclough & Houston, 2004;
, others found no global metabolic changes after mental effort expenditure 
(Finley et al., 2019;
Westbrook & Braver, 2015)
. Blood glucose levels do not vary much if at all during cognitive demanding tasks 
(Gibson, 2007;
Kurzban, 2010)
. Even "resting" mental activity could be construed as metabolically costly, insofar as specific task performance hardly consumes more brain energy than does resting activity 
(Raichle & Mintun, 2006)
.
As an alternative to the resource-based view, some theorists have endorsed a more motivationally-oriented perspective of mental fatigue 
(Hockey, 2011)
. In this view, mental fatigue alters the willingness (rather than the ability) to expend effort. This perspective has received support from studies testing the effects of external rewards on mental effort. Both monetary incentives 
(Boksem et al., 2006;
Muraven & Slessareva, 2003)
 and non-monetary incentives 
(Hopstaken et al., 2015;
Hopstaken et al., 2016)
 have been found to reverse the characteristic signs of task disengagement associated with mental fatigue. Hence, even after fatigue has set in, performance and associated physiological indicators of attention control can be restored to (or near to) pre-fatigue levels by offering incentives for performance. These results supported the idea that individuals tend to invest precious cognitive capacities in tasks that yield higher rewards (compared to the costs), and increasing the value of a task (i.e., increasing motivation) makes expending effort on it more likely. In terms of subjective value, we propose that mental fatigue affects the perceived costs and rewards of mental operations and, consequently, the motivation for exerting mental effort. Changing the reward/cost balance by introducing incentives for performance can thus modulate the allocation of effort under mental fatigue.
A sound model of mental fatigue should be able to explain some crucial established empirical findings, including evidence that (a) mentally fatigued people become inclined to disengage from effortful tasks and reduce further effort exertion 
(Giacomantonio et al., 2019;
Giacomantonio et al., 2014;
Hopstaken et al., 2016)
; and (b) extra incentives help to offset or reverse these negative effects of mental fatigue 
(Boksem et al., 2005;
Hopstaken et al., 2015)
. Below we develop a mathematical model intended to account for these established patterns. We intend the proposed approach to be used in future work to further understanding of the causes and consequences of mental fatigue.


Contribution
To our knowledge, the existing literature lacks modeling and estimation methods for testing the extent to which fatigue changes during cognitive exertion, and the extent to which perceived rewards and costs of mental effort change under mental fatigue. In this manuscript we developed a quantitative model and estimation methods to examine how mental fatigue affects the allocation of effort during cognitively demanding tasks.
In the proposed model, at each decision epoch, a human subject (agent) decides the amount of effort to exert, expecting performance-related rewards in return for the costs of mobilizing mental effort. We assume that the agent chooses the amount of mental effort expenditure that maximizes total subjective value over the extended task duration, and further we assume that the fatigue state is imperfectly self-perceived by the agent. The transition between fatigue states follows a hidden semi-Markov process, i.e., the likelihood of transition to a more fatigued state is a function of the current state and the elapsed time in the current state. We take a "Bayesian brain" perspective, which postulates that the agent infers hidden causes of sensations based on generative models 
(Friston, 2012;
Knill & Pouget, 2004)
, 1 and assume that humans rep-resent sensory information of hidden fatigue states through Bayesian belief and update the belief upon encountering new input data (a Bayesian belief is the posterior distribution over possible fatigue states, given sensory related and behavioral data). 
2
 We develop a method to estimate the parameters of the model, including the hidden fatigue dynamics and the subjective values of effort expenditure, using sensory and behavioral data as well as effort allocation decisions. We tested the estimation method via a simulated n-back task under a free choice paradigm with model parameters fine-tuned from the published literature. The aims were to identify the model primitives and to correctly predict common empirical findings such as the decline in performance and task engagement due to increased fatigue 
(Giacomantonio et al., 2019;
Hopstaken et al., 2016)
, and task re-engagement due to extra incentives 
(Giacomantonio et al., 2019;
Giacomantonio et al., 2014;
Hopstaken et al., 2015)
. This work advances methods for explaining effort allocation decisions and provides new avenues for empirically relevant understanding of how effort expenditure is affected by mental fatigue.


Review of Relevant Mathematical Background Partially Observable Markov Decision Processes
Markov decision processes (MDPs) are used to model optimal inter-temporal decision making 
(Bellman, 1966;
Puterman, 2014;
Ross, 2014)
. At each decision epoch t > 0, the agent observes the state of the environment s t and selects an action (makes a decision) a t . The action a t yields a reward r(s t , a t ) (depending on both state and action) and leads to a change in the state of the environment. The transition of the state is characterized in a probabilistic manner by a conditional probability P(s t+1 |s t , a t ). The agent observes s t+1 before making the next choice and so on and so forth.
Partially observable Markov decision processes (POMDPs) generalize MDPs by taking into account the fact that the states of the environment may not be perfectly observed 
(Cassandra, 1994;
Monahan, 1982;
Smallwood & Sondik, 1973)
. 
3
 Due to the hidden nature of environment states, the agent has to infer the state and makes decisions based upon all possible observed histories (including all past decisions and state-correlated noisy measurements); see 
Figure 1
. The consequence is that the relevant history grows exponentially as more decision epochs are considered. Fortunately, for a Bayesian agent, a belief -a probability distribution over the state space -is sufficient to derive an optimal policy. The decision making process is similar to MDPs: At decision epoch t, the agent observes a hidden state-correlated observation z t and updates belief x t based on previous belief x t−1 , previous action a t−1 and z t . A decision a t is made based on x t . Upon execution of the decision a t , the agent receives a reward and its expectation is denoted by r(x, a). A transition of the hidden state resulting from decision a t is described by P(s t+1 , z t+1 |s t , a t ). The goal for the agent is to maximize the expected cumulative reward:
E[ ∞ t=0 β t r(s t , a t )|x 0 ]
. A six tuple (S, A, Z, P, r, β) formally defines a POMDP, where S is the set of possible hidden states, A is the set of available actions, Z is the set of possible observations, the dynamics of the hidden state is P : S × A → S × Z, and r : S × A → R is the reward function. MDPs and POMDPs have been used in modeling human behaviors -such as goal-directed decision making under uncertainty -and their biological foundations 
(Dayan & Daw, 2008;
Seymour et al., 2004)
.


Figure 1
Structure of POMDPs. At each decision epoch t, a hidden environment state s t emits a correlated observation z t . The agent makes a decision by consulting z t in addition to all past actions and observations. The hidden state s t is influenced by the selected action a t and transitions to s t+1 .


Inverse Reinforcement Learning and Dynamic Discrete Choice Models
Inverse reinforcement learning (IRL) is an approach to estimate the preferences (modeled by reward functions) of an agent in goal-directed behavior, in order to explain why some behaviors are more preferred than others 
(Abbeel & Ng, 2004;
Arora & Doshi, 2018;
Dvijotham & Todorov, 2010;
Ng & Russell, 2000)
. Note that although both IRL and MDP approaches attempt to model optimal behavior in the sense of utility maximization, the two approaches are different: the goal of MDPs is to derive an optimal policy for a given (known) set of model parameters, whereas IRL assumes the optimal behaviors are exhibited in the data but the corresponding model parameters are unknown. The goal of IRL is to "learn" the parameters from the given data (hence "inverse").
to the modeling approach that describes hidden causes X and their dependent observables Y via a joint distribution P(X, Y) 
(Jebara, 2012;
Ng & Jordan, 2002)
.
2 Sensory related data may include electroencephalography, electrocardiography, pupil diameter, etc. Behavioral data may include task performance indices such as reaction times, error rates, etc.
3 In general, the environment includes both external states such as temperature and humidity, and internal states. In this work, by environment states we mean human psychological states, or more specifically, mental fatigue states.
Specifically, for a classic model-based IRL approach, the goal is to learn the reward function (i.e., the agent's relative preferences for the available options). Whereas IRL may be capable of learning human driving behaviors 
(Kuderer et al., 2015)
, training robots 
(Finn et al., 2016)
, and understanding other's intentions (Theory of Mind) (Jara-Ettinger, 2019), the method has shortcomings. One crucial issue overlooked by the IRL approach stems from its assumption that the agent perfectly observes the environment. This assumption is almost certainly inaccurate. Even if the environment were fully observable, human perceptions and measures are noisy and ambiguous 
(Schmitt et al., 2017)
. One study attempted to tackle this issue by developing a model to estimate the reward function in a partially observable environment 
(Choi & Kim, 2011)
. However, in that work, how the state of the environment changes (i.e., environment state dynamics) was assumed to be known. This assumption was likely overly restrictive and simplistic: Changes in many subjective states (such as mental fatigue) are context dependent and influenced by individual differences and hence may not be known in advance.
Econometricians have also developed estimation methods for inferring the parameters of the agent's utility model from decision data, which are generally denoted by structural estimation. 
Rust (1987)
 authored a seminal work that extended the scope of structural estimation to MDPs by developing a nested fixed point method to estimate (completely observed) environment state dynamics and reward function, based on an agent's decision making history. Following 
Rust (1987)
, a class of dynamic discrete choice (DDC) models was developed to describe (and estimate and predict) the decision making behaviors of a forward-looking agent 
(Aguirregabiria & Mira, 2010;
Keane et al., 2011)
. DDC models have been used in the study of human economic behaviors such as labor supply 
(Heckman, 1974)
, education policy 
(Todd & Wolpin, 2006)
, career decisions among politicians 
(Diermeier et al., 2005
) and many others. However, most DDC models assume that the environment is fully observable. The limitations associated with assuming fully observable states have recently garnered attention. 
Chang et al. (2020)
 generalized the 
Rust (1987)
 model to incorporate hidden states with Markov dynamics, and a maximum likelihood estimation procedure was developed to recover both the reward function and the hidden state dynamics. In the present work, we will generalize Chang et al.'s method to include semi-Markov states and apply it to learning the hidden dynamics of mental fatigue and the subjective values of a human agent in the context of mental effort allocation.


Hidden Markov Models and Hidden Semi-Markov Models
The class of hidden Markov models (HMMs) is a statistical framework for the Markov processes in which the environment states are unobserved. Similar to POMDPs, an observable process (observation) is available in an HMM and is dependent on the underlying hidden Markov process. The difference between HMMs and POMDPs is that HMMs do not involve actions (i.e., no decision-making process). At time t > 0, the environment occupies a (hidden) state s t and the environment releases an observable signal z t dependent on s t . Moreover, the underlying s t transitions to s t+1 stochastically, following the hidden state dynamics P(s t+1 |s t ); see 
Figure  2
. The three major goals of HMMs are: (a) to compute the likelihood of an observed data sequence {z t }, and (b) to find the most likely hidden state sequence {s t } for a given history of observations, and (c) to learn hidden state dynamics that define an HMM 
(Baum & Petrie, 1966;
Baum et al., 1970;
Eddy, 2004;
Mor et al., 2020)
.


Figure 2
Structure of HMMs. At each time t, the environment state s t is hidden but a state-dependent observation z t will be emitted. The hidden environment state transitions stochastically, according to a Markov chain (no actions are involved).
Sojourn time describes the amount of time one spends in an environment state before exiting that state. In the study of mental fatigue, sojourn time may be used to characterize the amount of time an individual remains in a particular fatigue state (e.g., fatigued or not fatigued). Classic HMMs are restricted to the case wherein the sojourn time distribution of a hidden state is memoryless. The class of hidden semi-Markov models (HSMMs), a variation of HMMs, allows for more flexible state-duration (sojourn time) modeling 
(Yu, 2010)
. See 
Figure 3
 for an illustration of the structure of HSMMs. In an HSMM, when the environment transitions to a different state, it remains in that state for d time periods and emits d (possibly different) observations. The distribution of duration d can follow a variety of probability distributions 
(Mor et al., 2020)
. In other words, HSMMs explicitly consider and model the time the environment has spent in the current state s, or the time left in the current state s (before transitioning to another state s ′ s). HMMs and HSMMs have enabled wide applications in the study of mental fatigue 
(Fu et al., 2016;
Liu et al., 2010;
Y. Luo & Qi, 2019;
Zhang et al., 2008)
, and other psychological states such as affect 
(D'Mello & Graesser, 2010;
Le & Provost, 2013)
, and brain electrical activity 
(Doroshenkov et al., 2007;
Obermaier et al., 2001;
Power et al., 2010;
Wang et al., 2013)
 


Figure 3
Structure of HSMMs. The environment remains in a state s for duration d, during which the observation is stochastically dependent on the current occupied state s. The transition of a hidden environment state to a different state is probabilistic once the time left in the current state is 0.


A Mathematical Framework of Effort Allocation under Mental Fatigue
In this section, we propose a model to formalize the effects of mental fatigue on effort allocation. We take a reward/cost trade-off perspective, attributing mental effort allocation to subjective values. 
4
 In this section we focus on modeling mental effort allocation as the maximization of the expected cumulative subjective values over the duration of a cognitively demanding task. A concrete example of mental effort allocation including a parameterization of costs and rewards under the effects of mental fatigue will be described below (under N-back Task).
At each decision epoch t > 0, the agent's fatigue state s t ∈ S is not directly observable (either to the agent or to observers), although a noisy observation z t ∈ Z (e.g., a physiological or behavioral measure) of the fatigue state is available. Let a t ∈ A be the effort allocation choice and τ t ∈ D be the duration of the relevant inner state (hidden to both the agent and to observers), indicating the time left in the current fatigue state at time t. In this work, the fatigue state space S, the observation space Z, the action space A, and the temporal duration space D are assumed to be finite. The inter-temporal transition of both fatigue state and its duration is denoted by transition probabilities
{P(s ′ , τ ′ , z|s, τ, a) : s, s ′ ∈ S, z ∈ Z, τ ′ , τ ∈ D, a ∈ A}. 5
One-step subjective value r(s, a) is the trade-off between rewards and costs for a specific decision epoch, which is a function of both fatigue state s and selected effort level a. Subjective value functions could be non-parametric or parametric (such as linear, parabolic, hyperbolic, or exponential functions of both fatigue level s and effort level a). It is possible that z t may not fully capture the information that the agent has available for decision making (e.g., the agent may possess private information that influences subjective values and decisions). We thus assume that one-step subjective value is perturbed by a random factor ϵ = {ϵ(a) : a ∈ A}, wherein the a th element of vector ϵ stands for the privately observed perturbation when the agent chooses to execute decision a. 6 See 
Figure 4
 for a schematic representation.
Let ζ t = {x 0 , a 0 , z 1 , a 1 , z 2 , ..., a t−1 , z t } be the history until time t, containing all observable information including past effort allocation choices {a 0 , a 1 , ..., a t−1 } and past observations {z 0 , z 1 , ..., z t }, wherein ζ 0 = {x 0 } and x 0 = {P(s 0 , τ 0 ) : s 0 ∈ S, τ 0 ∈ D} is the agent's initial belief (self-perception) of his or her fatigue state and its duration. Assume the agent is rational with the goal of maximizing expected cumulative subjective values over task periods T :
max a 0 ,...,a T E        T t=0 β t (r(s t , a t ) + ϵ(a t ))|ζ 0        ,
(1)
where E is the expectation operator conditional on ζ 0 , and β ∈ [0, 1) is the discount factor. 7
Following the convention of DDC models, we impose two standard assumptions on random perturbations ϵ.
Assumption 1 (Conditional Independence).
P(z t+1 , ϵ t+1 |ζ t , a t , ϵ t ) = P(ϵ t+1 )P(z t+1 |ζ t , a t ).
Assumption 1 restricts the random perturbation ϵ t to be independently and identically distributed (i.i.d) over both its own history {ϵ t−1 , ϵ t−2 , ...} and other factors (such as fatigue state s and noisy measurements z). Similarly, we assume that the reduced form observation probability P(z t+1 |ζ t , a t ) is independent of ϵ t+1 (i.e., we posit that small perturbations in the preference for a task do not dramatically alter task performance or physiological states). 8
4 Subjective values are construed as the difference between potential rewards for successful task performance and the costs incurred to achieve those rewards. Subjective values can be constructed in many ways by using various formulations of rewards and costs 
(Atkinson, 1957;
Chong et al., 2017;
Hartmann et al., 2013;
Klein-Flügge et al., 2015)
. 
5
 In reality, a person may experience faster or slower fatigue deterioration depending on his or her current state and the task at hand. As a result, sojourn times for different fatigue states may vary. 
6
 The information discrepancy between agents and observers may contribute to the bounded rationality observed in many human behaviors, which may help to account for why people sometimes appear to behave non-optimally 
(Gershman et al., 2015;
Griffiths et al., 2015;
Puranam et al., 2015;
Shenhav et al., 2017)
.
7 Some readers may find that the proposed model (1) can be seen as a partially observable semi-Markov decision process (POSMDP) with reward perturbation ϵ. Whereas the POSMDP literature has focused on computing an optimal control strategy for a known set of model parameters, our goal is to model mental fatigue and estimate the (unknown) parameters of a model based upon observable data.
8 Assumption 1 allows for effective computation of expected cumulative subjective values. However, small perturbations in task preferences may alter task performance or physiological states. Ex- 
= 0). Assumption 2 (Additively Separable One-step Subjective Values). s t ,τ t P(s t , τ t |ζ t , ϵ t )r(s t , a t ) = s t ,τ t P(s t , τ t |ζ t )r(s t , a t ) + ϵ t (a t ).
Assumption 2 states that random perturbation ϵ contributes to (one-step) subjective values as a random factor, characterizing unexpected or unpredictable influences or bounded rationality when choices are made.
Under Assumptions 1-2, the expected cumulative subjective value from time t can be written via the Bellman Equation 
(Bellman, 1966)
:
g t (ζ t , ϵ t ) = max a t s t τ t P(s t , τ t |ζ t )r(s t , a t ) + ϵ t (a t ) + β z t+1 P(z t+1 |ζ t , a t ) g t+1 (ζ t+1 , ϵ t+1 )dµ(ϵ t+1 ) ,
(2)
where µ is the cumulative distribution function of multivariate random variable ϵ (of dimension |A|).
We call g t (ζ t , ϵ t ) the expected cumulative subjective value function, which can be decomposed into two parts: a present value and an expected future value. From the perspective of the decision-making agent (ϵ is known before acting):
1. The first part
s t τ t P(s t , τ t |ζ t )r(s t , a t ) + ϵ t (a t )
is the perturbed one-step expected subjective value for choice a t , given the self-perception of both fatigue state and its duration inferred from observable history P(s t , τ t |ζ t ). 2. The second part
β z t+1 P(z t+1 |ζ t , a t ) g t+1 (ζ t+1 , ϵ t+1 )dµ(ϵ t+1 )
is the forward-looking expected cumulative subjective value function, which weighs every possible future scenario (z t+1 , ϵ t+1 ) by their probabilities (P(z t+1 |ζ t , a t ), dµ(ϵ t+1 )). Specifically, at time t+1, different observations (z t+1 ) may be emitted by the underlying hidden state s t+1 , which, together with choice taken at time t (a t ), updates the history ζ t to ζ t+1 (i.e., ζ t+1 = {ζ t , a t , z t+1 }). Moreover, random perturbation (ϵ t+1 ) may also take a different value. So there are two layers of expectation ( z t+1 P(z t+1 |ζ t , a t ), . . . dµ(ϵ t+1 )), corresponding to the expectation over observations and the expectation over random perturbations. Finding solution to Equation (2) is difficult as ζ grows exponentially with as time increases. To resolve this issue, let X be the (finite dimensional) probability simplex in R |S×D| and x t ≜ {P(s t , τ t |ζ t ) : (s t , τ t ) ∈ S × D} ∈ X be the Bayesian belief (or belief, used interchangeably from here on), which is the posterior distribution over possible fatigue states and its duration (s t , τ t ) given history ζ t up to time t. Compared to ζ t , the size of belief x t remains constant and does not grow to infinity as t increases (i.e., x t ∈ X, ∀t), which enables an efficient solution to Equation (2). According to Bayes rule, upon observing a t , z t+1 , the belief can be updated as:
x t+1 (s, τ) = P(s t+1 = s, τ t+1 = τ|z t+1 , a t , ζ t ) = s t ,τ t P(s t+1 = s, τ t+1 = τ, z t+1 |s t , τ t , a t )x t (s t , τ t ) σ(x t , a t , z t+1 ) ,
(3)
amining how ϵ may affect physiological states or performance requires a more complicated dependent structure of state dynamics P(z t+1 , ϵ t+1 |ζ t , a t , ϵ t ), which represents a potentially valuable avenue for future research.
wherein the denominator is the reduced observation probability:
σ(x t , a t , z t+1 ) ≜ P(z t+1 |x t , a t ) = s t+1 ,τ t+1 s t ,τ t P(s t+1 , τ t+1 , z t+1 |s t , τ t , a t )x t (s t , τ t )
(4)
We denote the belief updating process by x t+1 = λ(x t , a t , z t+1 ). 9 With the definition of belief x, the following theorem formally states that the Bayesian belief x is sufficient to determine the cumulative subjective value function g. Theorem 1. Let ζ t = ζ be the history of observations and actions up to time t, the belief state, action and random reward perturbation at time t are
x t = x, a t = a, ϵ t = ϵ. Define V t (x, ϵ) ≜ max a r(x, a) + ϵ(a) + β z ′ σ(x, a, z ′ ) V t+1 (x ′ , ϵ ′ )dµ(ϵ ′ ) ,
(5)
where z ′ , ϵ ′ are the observation and random perturbation vector at time t + 1, the updated belief at t + 1 is
x ′ = λ(x, a, z ′ ), and r(x, a) = s,τ r(s, a)x(s, τ). Then V t (x, ϵ) = g t (ζ, ϵ).
Hence, the belief x is a sufficient statistic for the expected cumulative subjective value function g.
Theorem 1 shows that the proposed model in Equation (2) is indeed reformulated to a POMDP-based DDC model in 
(Chang et al., 2020)
. Hence, it has the following implications. 10 For infinite T there is a unique (fixed point) value
function V such that: 11 V(x, ϵ) = max a r(x, a) + ϵ(a) + β z ′ σ(x, a, z ′ ) V(x ′ , ϵ ′ )dµ(ϵ ′ ) ,
where
x ′ = λ(x, a, z ′ ).
The existence of the value function V, in the context of mental effort allocation, enables us to analyze mental effort expenditure behaviors as follows. Let
Q(x, a) = r(x, a) + β z ′ σ(x, a, z ′ ) V(x ′ , ϵ ′ )dµ(ϵ ′ ), (6) where x ′ = λ(x, a, z ′ ).
Then the optimal choice a * for the agent is
a * ∈ arg max a Q(x, a) + ϵ(a) .
For an observer, the value of ϵ required to derive an optimal decision a * is not available, so the observer can only consider and sum up each possible value of (random variable) ϵ weighted by its corresponding probabilities. This integrated optimal policy (for observers) is thus probabilistic and is called a conditional choice probability (CCP), denoted by
π(a|x) ≜ P a ∈ arg max a ′ Q(x, a ′ ) + ϵ(a ′ ) .
In addition to Assumptions 1-2, we also assume ϵ follows an i.i.d multivariate Gumbel distribution, i.e., Assumption 3 (i.i.d Gumbel random perturbations). ϵ is i.i.d and follows multivariate Gumbel distribution, or:
µ(dϵ) = a∈A exp {−ϵ(a) + γ} exp exp{−ϵ(a) + γ} ,
where γ ≈ 0.5772 is the Euler's constant.
Then, the expected cumulative subjective value function over random perturbation ϵ has the closed-form expression:
V(x) ≜ V(x, ϵ)dµ(ϵ) = γ + log a exp Q(x, a).
Moreover, the CCP has the closed-form expression: 12
π(a|x) = exp Q(x, a) a ′ exp Q(x, a ′ )
.


Maximum Likelihood Estimation
Our estimation goal is to identify the dynamics of mental
fatigue {P θ D (s ′ , τ ′ , z|s, τ, a) : s, s ′ ∈ S, τ, τ ′ ∈ D, z ∈ Z,
a ∈ A} and one-step subjective values {r θ R (s, a) : s ∈ S, a ∈ A} from data (i.e., ζ T ), whereby we parameterize fatigue dynamics by vector θ D and subjective value by vector θ R . Ideally, researchers should use data from experiments with human subjects. In this manuscript, we will use simulated data to illustrate the estimation procedure developed in this section. It is well known that DDC models are in general not identifiable (i.e, it is impossible to uniquely recover model parameters from data). Our proposed model, in Equation 
2
and Equation 
5
, entails DDC models and hence is no exception. However, 
Chang et al. (2020)
 provided the following conditions to uniquely determine the model primitives.
1. The dynamics of mental fatigue
{P θ D (s ′ , τ ′ , z|s, τ, a) : s, s ′ ∈ S, τ, τ ′ ∈ D, z ∈ Z,
a ∈ A} can be estimated from data if (a) each data sequence contains two (or more) periods of data; (b) both initial belief x 0 and the cardinality of fatigue state space S and longest duration in a fatigue state D (i.e., |S|, |D|) are known. 13 2. One-step subjective values {r θ R (s, a) : s ∈ S, a ∈ A} can be identified from data if the following quantities are known: (a) the cardinality of state space S and D;
(b) cumulative distribution function of random perturbation µ; (c) discount factor β; 14 (d) one-step subjective values for a reference action a 0 , {r(s, a 0 ), ∀s ∈ S}. That is, one-step subjective values are only identified up to a constant (i.e., only the differences in r(s, a) − r(s, a 0 ) can be estimated, not the absolute values). Under these conditions, maximum likelihood estimation can be used to find the value of θ D , θ R that jointly maximizes the likelihood function of given observable histories ζ T s. Assume we have N independently generated histories in the form of data = {(x n 0 , a n t , z n t+1 ), 0 ≤ t ≤ T } N n=1 , with each history containing T + 1 decision epochs. The log-likelihood function can be factorized by reduced form observation probabilities and CCPs:
log ℓ(θ D , θ R |data) ≜ N n=1 T t=0 log P θ D (z n t+1 |x n t , a n t )P θ D ,θ R (a n t |x n t ) = N n=1 T t=0 log σ θ D (x n t , a n t , z n t+1 ) + log π θ D ,θ R (a n t |x n t ) .
The estimation can be split into two phases. In the first phase, we estimate θ D by maximizing a partial log-likelihood function regarding reduced form observations because it only contains θ D . The maximum likelihood estimator is denoted
byθ D :θ D ∈ arg max θ D N n=1 T t=0 log σ θ D (x n t , a n t , z n t+1 ).
In the second phase, we useθ D obtained from phase 1 as a given and maximize a partial likelihood function containing CCPs:θ
R ∈ arg max θ R N n=1 T t=0 log πˆθ D ,θ R (a n t |x n t ),
wherein the maximum likelihood estimator of θ R is denoted bŷ θ R . 15 
Figure 5
 depicts our proposed modeling and estimation framework. Note that we further assume
P θ D (s ′ , τ ′ , z ′ |s, a, τ) = P θ 1 (s ′ , τ ′ |s, a, τ)P θ 2 (z ′ |s ′ ),
where θ D = (θ 1 , θ 2 ). Physiological and behavioral measures correlate with underlying fatigue states (although this correlation is far from perfect 
(Bijleveld, 2018)
). Thus, we model the observation as a conditional probability given current fatigue state P(z|s), which is commonly called an observation probability. More accurate measurements will be more likely to reflect the true fatigue state.


N-back Task
In this section we apply the proposed model and estimation procedure to a simulated n-back task. We begin by explaining important model components and expressing them in mathematical terms. Then we give concrete values to the model parameters for a simulated n-back task. A fully specified model allows us to simulate rational mental effort allocations and changes in fatigue, and to illustrate the proposed estimation procedure. We also discuss the estimation results and validate the estimated model by comparing its predictions to empirical results from the relevant literature on mental fatigue and effort expenditure. Last, we perform robustness analysis for cases wherein required prior knowledge for the model to function is unknown. The current study was not pre-registered. The code and related data used in the current work are provided to the review team and will be publicly available in the event that the manuscript is accepted for publication.


Fatigue and Mental Effort Allocation during an N-back Task
Task setup. We consider a free choice task environment composed of several blocks of the n-back task, which is a task commonly used to manipulate mental fatigue. We assumed that higher levels of task difficulty (i.e., larger n) lead to higher payoffs (e.g., monetary rewards) for successful performance but also carry higher psychological costs. For each block, the agent's choice of task difficulty level (a t = n, n = 1, 2, 3, wherein n = 1 is the easiest version of the task) and fatigue-related measures (z t ) will be recorded,


Figure 5
Modeling of mental fatigue and its effects on effort allocation. The Blue circle contains an abstraction of changes or transitions in mental fatigue states. The inter-temporal dynamics of both the hidden fatigue state and its duration are parameterized by θ 1 . Noisy measurements (such as behavioral or physiological data) of fatigue states are denoted by observations and are stochastically dependent on the underlying hidden fatigue state. This dependent structure is captured by P θ 2 (z|s). Decisions refer to the agent's choice of difficulty level (i.e., effort allocation) for the upcoming block of the cognitive task, which manifests a subject's preference for the level of effort to be exerted and results in changes to both fatigue state and its duration. The Yellow circle depicts our proposed model for describing mental effort allocation. The model assumes that the agent exerts mental effort to maximize the expected cumulative subjective value (immediate value plus future expected value) of successful task performance, which is determined by fatigue dynamics, observation probabilities, and one-step subjective values (parameterized by θ R ). This subjective value is a function of the fatigue state at each decision epoch. Because fatigue states and their duration are hidden, the model assumes that the agent self-perceives his or her fatigue state and its duration, described by the belief x. The Green box displays the estimation procedures for the model parameters, including fatigue dynamics (θ 1 ), observation probabilities (θ 2 ), and one-step subjective values (θ R ). Specifically, we first do partial estimation regarding fatigue dynamics (P θ 1 (s ′ , τ ′ |s, τ, a)) and observation probabilities (P θ 2 (z|s)). Then, we use the estimators of fatigue dynamics and observation probabilities to estimate one-step subjective values (r θ R (s, a)).
hence, ζ t+1 = {ζ t , a t , z t+1 }. 
16
 Model of mental fatigue dynamics. A common way to induce mental fatigue is to have subjects perform cognitively demanding tasks for a prolonged period of time 
(Boksem et al., 2005
(Boksem et al., , 2006
Hopstaken et al., 2015;
Hopstaken et al., 2016;
G. R. Wylie et al., 2020)
. Studies have observed that performing more demanding tasks leads to greater mental fatigue compared to performing less demanding tasks 
(Blain et al., 2016;
G. Wylie et al., 2017)
. To that end, task difficulty and time on task are factors worth investigating in the proposed model. We modeled changes in mental fatigue as a hidden semi-Markov process:
1. s t ∈ S = {1, 2, ..., S }: all possible values for fatigue state at time t. A larger value of s implies a more fatigued state. 2. τ t ∈ D = {1, 2, ..., D}: time left in current state s t at time t, the maximum of which is D. Ideally, D should be less than the duration of the experiment so that subjects become fatigued before the experiment ends.
Then we have
P(s t+1 , τ t+1 , z t+1 |s t , τ t , a t ),
(7)
to describe transitions between fatigue states at consecutive decision epochs.
The one-step subjective values r(s, a). The subjective value r(s, a) considers the trade-off between rewards b(s, a) and costs c(s, a) for a single decision period:
r(s, a) = b(s, a) − c(s, a).
Note that by Assumption 2, random perturbations in subjective values ϵ are usually not explicitly stated, yet softmax optimal policy used in extant studies of effort allocation 
(Chong et al., 2017;
Hartmann et al., 2013;
Klein-Flügge et al., 2015;
Prévost et al., 2010)
 were derived using certain assumptions for the distribution of ϵ (i.e., under the assumption that ϵ(a) is i.i.d across different actions and follows a Gumbel distribution, optimal action a ∈ arg max a ′ {r(s, a ′ ) + ϵ(a ′ )} is probabilistic with softmax form).
(a) Cost function c(s, a). To model the psychological costs for performing an n-back task, we could use the cost functions defined by existing work on cognitive control 
(Chong et al., 2017;
Hartmann et al., 2013;
Klein-Flügge et al., 2015;
Prévost et al., 2010)
 where k > 0 is the parameter characterizing individual or group differences and a is the task difficulty (see 
Figure 6
). In general, the parameter a in the cost function c(s, a) refers to effort rather than task difficulty. However, a positive correlation exists between task difficulty and the amount of effort to be exerted, particularly when task success is deemed likely 
(Brehm & Self, 1989;
Fairclough & Ewing, 2017)
. 
17
 (b) Reward function b(s, a). According to motivation theories and extant studies of cognitive control, the expected rewards for mental effort expenditure play an important role in guiding human behavior. In addition, subjective beliefs may influence the perceived value of external rewards. Subjective beliefs that may influence perceived value include self-efficacy and success probability (or expectancy) 
(Atkinson, 1957;
Bandura, 1977;
Feather, 1959a
Feather, , 1959b
Maier & Seligman, 1976;
Rotter, 1966;
Wabba & House, 1974)
. Despite differences in terminology, in general all these terms relate to the likelihood of succeeding at a prospective task. For example, the motivation to pursue a task or goal may be quantified by weighing possible task incentives with their associated success likelihoods, i.e., classic expectancy × value considerations 
(Reinharth & Wahba, 1975)
. Efficacy is crucial in the evaluation of subjective value, and thus influences effort


Figure 6
Commonly used one-step subjective costs, increasing as perceived effort increases. Typical forms of subjective costs include linear, hyperbolic, parabolic, and exponential.
allocation 
(Froemer et al., 2020)
. For example, 
Chow et al. (2015)
 found that participants report reduced self-efficacy for task-related exertions after performing a mentally-demanding task. Here, we define self-efficacy beliefs as the subjective evaluation of the probability of succeeding at a given task: e(s, a) = P(success|s, a),
where e(s, a) links both task difficulty a (effort level) and fatigue state s to success probability. In terms of the n-back task, self-efficacy describes how confident a subject is in being able to succeed (i.e., meet performance criteria). According to existing research and theory, we expected e(s, a) to decrease as the task becomes more difficult or as the subject becomes more fatigued. Consequently, the reward function reflects external incentive values combined with self-efficacy beliefs: b(s, a) = e(s, a)incentive(a; c p ), wherein incentive(a; c p ) is the monetary payoff subjects would receive upon meeting the (predetermined) performance criteria c p for the task a. Performance criteria c p are specified by the experiment design and will be omitted in the function b(s, a) for brevity.
Expected cumulative subjective value function. The one-step subjective value r(s, a) is the subjective value for a specific decision epoch. The optimal allocation of effort for a forward-looking agent is to maximize the expected cumulative subjective values over horizon T :
{a 0 , a 1 , ..., a T } ∈ arg max a 0 ,...,a T E        T t=0 β t (r(s t , a t ) + ϵ(a t ))|ζ 0        ,
where β ∈ [0, 1) is the discount factor. The operator E denotes the expectation over all stochastic components: (a) all future actions yet to be selected; (b) all future random perturbations ϵ; and (c) all future fatigue states and their duration times (s, τ) that transition stochastically.


Simulated N-back Tasks with Changing Fatigue
We assume that the current fatigue state is either 1 (s = 1 for not fatigued) or 2 (s = 2 for fatigued). The temporal duration of staying in one of these fatigue states τ takes possible values from 0∼4 (blocks of trials). 
18
 We assume the following conditional independence of the dynamics of fatigue state and its duration:
P (s t+1 , τ t+1 , z t+1 |s t , a t , τ t ) = P(s t+1 |s t , a t , τ t )P(τ t+1 |s t+1 , a t , τ t )P(z t+1 |s t+1 ),
and that:
1. Fatigue is more likely to occur when the agent chooses to perform (and then performs) harder tasks. Here we assume that choosing to perform more difficult tasks of n ≥ 2 when τ = 0 (about to get tired) will fatigue the agent with probability 1, i.e., P(s t+1 = 2|s t , τ t = 0, a t 1) = 1, ∀s t . Choosing the easiest task a t = 1 will help the agent to recover, so P(s t+1 = 1|s t , τ t = 0, a t = 1) = 1, ∀s t . Note that when τ > 0, s t+1 = s t regardless of choice a t . 19 2. Performing harder tasks will increase the probability of transitioning to the fatigued state, and the agent will also need more time to recover from that fatigued state. For example, P(τ t+1 = 4|s t+1 = 2, τ t = 0, a t = 3) ≥ P(τ t+1 = 4|s t+1 = 2, τ t = 0, a t = 2) implies that for the next state, the probability of staying in a fatigued state for 5 blocks (the longest possible duration) is greater when the current choice was to perform the 3-back task, compared to the 2-back task. Note that when τ > 0, τ t+1 = τ t − 1 regardless of choice a t . For (one-step) subjective values, we use a linear cost function (with respect to effort level) and a weighted reward function (weighted by self-efficacy beliefs), which is parameterized by
θ 3 = {θ 3,1 , θ 3,2 }: 20 r(s, a) ≜ b(s, a) − c(s, a) = θ 3,1 sa incentive(a) − θ 3,2 sa,
where we assume self-efficacy has the form e(s, a) =
θ 3,1
sa , and where θ 3,1 , θ 3,2 are positive real numbers to be estimated as part of the model parameters.
To simulate an n-back task environment, we had to predetermine the value of the model parameters. There are no prior studies incorporating both a free choice paradigm and mental fatigue due to performing the n-back task. Nevertheless, Hopstaken et al. (2015) provided a referable benchmark. They studied the effects of mental fatigue on task performance during a prolonged series of n-back tasks. The authors observed changes in task performance (measured in d-prime), physiological states (P3 amplitude, pupil diameter), and self-reports of fatigue. We thus adapted data from the their experiment to define our simulation environment. Note that free choice over n-back task difficulty was not included in Hopstaken et al., which could have been used by our model to identify subjective values from participants' behaviors.
1. We parameterize the transition between fatigue states P(s ′ |s, a, τ = 0) in a deterministic fashion because only two states are possible; leaving one state necessarily leads to entering the other. This parameter is treated as known and thus did not need to be estimated. 
21
 Specifically, we have:
(a) P(s ′ = 2|s, τ = 0, a) = 0, a = 1, ∀s; (b) P(s ′ = 2|s, τ = 0, a) = 1, a = 2, 3, ∀s; (c) P(s ′ = 1|s, τ = 0, a) = 1, a = 1, ∀s; (d) P(s ′ = 1|s, τ = 0, a) = 0, a = 2, 3, ∀s. 2.
The sojourn time distribution is described by θ 1 , or
P θ 1 (τ ′ |s ′ , a, τ = 0), where θ 1 = {θ 1,1 , θ 1,2 , θ 1,3 } (see def- initions below)
. We assume that sojourn times follow a binomial distribution. Note that the binomial distribution takes two parameters, the second of which is defined as the maximum number of blocks a state can persist, which is fixed to 4. 
22
 This follows from the experiment by 
Hopstaken et al. (2015)
, in which subjects exhibited signs of fatigue within 5 consecutive blocks of n-back task performance. (a) P(τ ′ |s ′ = 1, a = 1, τ = 0) ∼ B(θ 1,1 = 0.1, 4);
18 Note that in 
Hopstaken et al. (2015)
, the subjects were fatigued within 5-6 blocks of trials. Here, we similarly assumed that fatigue can be induced within 5 blocks of trials, indicating that the maximal number of time one can stay in a not fatigued state is 5 (from block 0 ∼ block 4). 
19
 We will revisit those assumptions in the Limitations section to consider cases wherein the assumptions may not hold. 
20
 The same procedure can be applied for non-linear cost functions. 
21
 For the number of states greater than two, transition probabilities cannot be treated as known; they will be estimated as model primitives. See an example in Robustness Analysis section.
22 Note that in 
Hopstaken et al. (2015)
, blocks were coded from 1 (e.g., the first block of trials was labeled as Block 1). In this manuscript, we code from Block 0 (i.e., the first block of each sample path is Block 0). This decision aligns with the fact that binomial random variables can take 0 as a value. As a result, the second parameter of binomial distributions in the manuscript is 4 (rather than 5), which indicates a maximum sojourn time of 5 blocks (from Block 0 to Block 4).


Table 1
We mapped performance d-prime into integer space. For example, when d-prime is in the range [2.5, 2.75), corresponding z takes value 1.
d-prime [2.5, 2.75) [2.75, 3) [3, 3.25) [3.25, 3.5) z 1 2 3 4 (b) P(τ ′ |s ′ = 2, a = 2, τ = 0) ∼ B(θ 1,2 = 0.4, 4); (c) P(τ ′ |s ′ = 2, a = 3, τ = 0) ∼ B(θ 1,3 = 0.7, 4).
We designed average sojourn time in the fatigued state as longer for a = 3 than for a = 2. 23 3. The observation probability -which characterizes the relationship between a hidden fatigue state s and its observable noisy measurement z -is captured by θ 2 , or P θ 2 (z|s). We used the performance data reported in d-prime 
(Hopstaken et al., 2015)
 as the observation z.
Hopstaken et al. observed that average performance across subjects consistently declined. 24 Performance (d-prime) levels on the relevant n-back tasks observed by Hopstaken et al. fluctuated between 2.4 and 3.2. To make our model outputs and predictions comparable to their results, we borrowed their mean values for the highest performance level (d-prime ≈ 3.12 among not fatigued participants) and lowest performance level (dprime ≈ 2.54 among fatigued participants. Furthermore, we added variance to the performance variable to account for the fact that individual performance rarely matches the group-level mean. We constrained performance (d-prime) within a range [2.5, 3.5) because most of the findings reported by Hopstaken et al. fell within that range. We re-mapped the observation z from the discretized d-prime in 
Table 1
 and defined the observation probability P(z|s) in 
Table 2
. 4. We describe the one-step subjective value function by θ R = θ 3 = {θ 3,1 , θ 3,2 } = {2.5, 0.5}. 5. We specified the external incentives (rewards) earned for each block of n-back as: 1 unit of reward for the 1-back task, 3 units of reward for the 2-back task, and 6 units of reward for the 3-back task. The model parameter (to be estimated) of θ = {θ 1 , θ 2 , θ 3 } is summarized in the 
Table 3
. The discount factor β = 0.9, subjective value perturbation ϵ is assumed to be i.i.d and Gumbel-distributed (to ensure the model can be estimated). Now the proposed fatigue model is fully specified.


Model Estimation, Validation, and Results Analysis
We simulated 1000 sample paths with each path containing 40 consecutive blocks of trials (or 40 decision epochs) for the given value of θ. Recorded history includes choices (or actions) of the task difficulty levels and simulated task performance.


Table 2
Parameterization of observation probability by θ 2 . Note that P(z = 4|s) = 1 − P(z = 1, 2, 3|s), which does not require estimation.
z 1 2 3 s = 1 θ 2,1,1 = 0.01 θ 2,1,2 = 0.10 θ 2,1,3 = 0.79 s = 2 θ 2,2,1 = 0.69 θ 2,2,2 = 0.28 θ 2,2,3 = 0.02
Estimation results are displayed in 
Table 3
. Our estimation method was able to identify both fatigue dynamics and the one-step subjective value function with high precision. The maximum element-wise difference between the ground truth of the parameters and their estimates was 0.01 for θ 1 , θ 2 and θ 3 , which differed by no more than 4% relative to the ground truth.
In addition, the estimated model was able to validate classic findings from existing empirical studies. 
Figure 7
 compares the changes in fatigue due to prolonged n-back task performance reported by 
Hopstaken et al. (2015)
 to the predictions from our estimated model. 25 As time on task increased, Hopstaken et al. observed that participants' subjective feelings of fatigue increased in a concave manner (faster increases at the beginning and slower increases toward the end of the task). Our model revealed a similar increase in fatigue levels and captured the concave shape as well (see the declining slope of the blue solid line at Blocks 5 and 6). Note that our model expresses subjective fatigue in terms of probabilities, i.e., P(s = 2|ζ), whereas Hopstaken et al. gathered subjective reports of fatigue.
In 
Figure 8
 we compared 2-back task performance observed by 
Hopstaken et al. (2015)
 to our estimated model outputs. Performance (d-prime) declined as time on task increased in Hopstaken et al.; see orange dashed line. Our model used performance as a noisy indicator of underlying hidden fatigue states. As time on task increased, the model predicted declines in task performance. The predicted performance decline was faster for the first several blocks, after 
23
 In the parameterization of sojourn time distributions, we considered only cases (s ′ = 1, a = 1), (s ′ = 2, a = 2), (s ′ = 2, a = 3), because the aforementioned fatigue state transitions rule out other combinations. For example if a = 1, then s ′ 2. Similarly, s ′ 1 if a = 2, 3. 
24
 In their experiment, 3-back performance was consistently poor and showed a slight increase as time on task proceeded. We ignored their 3-back task findings in defining the range of performance values because, according to Hopstaken et al., the increase was likely induced by learning effects, which are not a focus of the current work.
25 Whereas our approach considers a free choice paradigm, Hopstaken et al. (2015) did not. Nonetheless, our model was able to generate predictions comparable to the data observed in Hopstaken et al.


Table 3
Model primitive parameters and their estimates. 
Parameter θ 1 θ 2 θ 3 θ 1,1 θ 1,2 θ 1,3 θ 2,1,1 θ 2,1,2 θ 2,1,3 θ 2,2,1 θ 2,2,2 θ 2,2,3 θ 3,1 θ 3,2


Figure 7
Fatigue increased with time on task, as reported in a past study and as predicted by our proposed model. 
25
 The orange dashed line represents the findings reported by 
Hopstaken et al. (2015)
 whereas the blue solid line shows the simulated results from our proposed model. which time the declines slowed down (flattened); see blue solid line. 
26
 Furthermore, 
Hopstaken et al. (2015)
 found declines in task engagement with increased time on task, but apparently reengagment when external incentives were promised for good performance 
(Figure 9
, orange dashed line). This pattern suggested that incentives alter the subjective value of mental effort expenditure and thus make expending effort more attractive. Such incentive-induced change can also be predicted by our model. To mimic the way Hopstaken et al. incentivized subjects for good performance, we increased base incentives for the 2-and 3-back tasks by 80%. The model predicted that agents become more prone to expend effort for potential rewards even though fatigued; see 
Figure 9
 (blue solid line). In our model, task engagement was defined by the probability of selecting more demanding tasks (2-back and 3-back), i.e., π(a = 2|x) + π(a = 3|x). Moreover, as subjective values kept increasing, our model predicted that the marginal gains in task engagement diminish (see 
Figure 10
). This finding is aligned with evidence that the marginal utility of rewards decreases once the rewards exceed a certain level 
(Grahek et al., 2020
; Kahneman 
& Tversky, 2013;
Morgenstern & Von Neumann, 1953;
Pine et al., 2009)
.


Robustness Analysis
Our model assumes that some of the model primitives are given, namely, the discount factor β and the number of fatigue states S . However, those assumptions may be overly restrictive relative to real life. For example, what is the number of hidden fatigue states that can best describe a subject's effort 
26
 The task setup from Hopstaken et al. was not exactly the same as the task we attempted to model; thus, we did not observe exactly the same "dip" in task performance of Block 4 found by Hopstaken et al., 
Figure 3
, 2-back task. Specifically, 
Figure 3
 in Hopstaken et al. was plotted by averaging data across all subjects, whereas our model is specified for an individual. In addition, their experiment paradigm did not involve free task selection. Thus, their data cannot be directly incorporated into our model. Rather, we used their data as a reference point and modified accordingly to fulfill our needs for establishing simulations. For example, we used their task performance (d-prime) range to determine the range of observations in our model.


Figure 9
Task engagement from 
Hopstaken et al. (2015)
 and from our model. 25 Orange dashed line: depicts the changes in self reported subjective feeling of task engagement adapted from 
Figure 2
 in 
Hopstaken et al. (2015)
. From Blocks 1∼6, engagement decreased while mental fatigue accumulated. And the willingness for further exertion reverted in Block 7 due to an external incentive guaranteed by the good performance. Blue solid line: exhibits the model simulated changes in the willingness to allocate effort as a function of time on task. We had simulated agents perform 2-back task for consecutive 7 blocks of trials. From Blocks 1∼6, the model predicted a decrease in willingness to exert effort, which was then reversed in Block 7 by introducing an external incentive for good performance (similar to the settings used in Hopstaken et al. (2015)). Specifically, when the extra monetary rewards equaled 80% of current monetary rewards for both 2-back and 3-back tasks, the predicted willingness to expend effort (i.e., the probability of choosing either the 2-back or 3-back task for the next block) reverted to (near) pre-fatigue levels, resulting in a probability increase from 0.2 (in Block 6) to 0.58 (in Block 7).
allocation? Or what is the inter-temporal discount factor a subject uses when making decisions? In this section, we will analyze our model's estimation performance in two concrete cases wherein the cardinality of state space (S ) or the intertemporal discount factor is (β) unknown.
Unknown value of β. The discount factor is involved in the computation of forward-looking subjective value functions. Variations in the discount factor may lead to (potentially large) differences in the value functions and thus affect the estimation of subjective value parameters and individual differences in decision making. The identification of the discount factor (from data) in dynamic discrete choice models is a theoretical challenge and an active area of research (e.g., 
Abbring & Daljord, 2020)
. It has been shown that the discount factor is not identifiable from decision choice data alone without


Figure 10
The marginal effects of the willingness to expend effort (i.e., the probability of choosing the 2-back or 3-back task) as a function of increased task rewards. The starting point of the curve is the probability of effort expenditure in simulated agents (built by the estimated model) who have performed the 2-back task for 6 blocks of trials. We manipulated the external incentives for successful performance for both 2-back and 3-back tasks in terms of proportionality of the increase (compared to current received rewards). We found that task engagement was increased by external rewards and grew rapidly as the rewards increased by between 0% to 150%. However, the marginal effects of task engagement diminished when external incentives exceeded a certain level (e.g., more than 200%) as depicted by the reduced slope of the curve. further restrictions 
(Magnac & Thesmar, 2002;
Rust, 1994)
. Usually, the identification of a discount factor requires additional context-dependent information (e.g., 
Bajari et al., 2016;
Norets & Tang, 2014)
.
To examine the effects due to unknown discount factor, we considered a case wherein the model settings (fatigue dynamics, subjective value parameters, etc.) remain the same as the simulated n-back task in the previous section, except that the discount factor β is unknown. To this end, we generated data using the discount factor β = 0.7. Then, we performed the proposed parameter estimation procedure assuming different true values of β ∈ [0, 1). To compare the model estimates and their true values, we denoted the estimates for certain β byθ 3 (β) = {θ 3,0 (β),θ 3,1 (β)} and the ground truth by θ 3 = {θ 3,0 , θ 3,1 }. (Note that phase 1 estimation of dynamics parameters does not involve β.) Then, the maximum elementwise percentage difference is defined as: 
Figure 11
 shows how the estimated log-likelihood and the difference (%) between estimated subjective value function The maximum log-likelihood and the minimum of D(θ 3 ,θ 3 ; β) were achieved simultaneously at the true β value (β = 0.7), as would be expected. From the 
Figure,
 see also that when the assumed β is close to the true β(= 0.7), the estimation result is acceptable in terms of both performance (log-likelihood, blue solid line) and the precision of the estimates (orange dashed line). For example, as the assumed value of the discount factor ranged between 0.6 and 0.8, there was no significant drop in model performance and the estimated percentage difference (compared to the true values) was under 20%, attesting the robustness of our approach. The simulation results shown in 
Figure 11
 imply that β values can be fine-tuned by numerical methods (such as uniformly searching values between 0 and 1), which represents a viable way to apply our model when the true discount factor is unknown.
D(θ 3 ,θ 3 (β); β) = 100 × max i∈{1,2} |θ 3,i −θ 3,i (β)| θ 3,i
In addition to a numerical searching method to find a proper value of the discount factor, another route for alleviating the reduced identifiability caused by an imprecise discount factor would be to gather additional (separate) evidence for a participant's (or a sample's average) discount factor. For example, performance on a classic delay discounting task could suggest a beta value on which to anchor the relevant model estimation parameter for understanding the impact of mental fatigue on effort allocation decisions. Please also refer to the Limitations section, wherein we address issues pertaining to the temporal discounting of subjective value.
Unknown cardinality of fatigue state space. Mental fatigue is a multi-faceted construct that may not be easily categorized or quantified. However, one can still find a reasonable set of fatigue categories or states that can be used to explain an agent's effort expenditure in terms of modeling. In principle, the choice of the number of fatigue states should


Figure 12
Model estimation performance under different numbers of fatigue states. Log-likelihood of simulated data set was computed from estimated models including 2-, 3-, or 4-state parameterizations. be kept parsimonious, because more states may lead to more parameters required to specify the model, and the increase in model parameters demands larger amounts of data to ensure the precision of model estimates. Akaike information criterion (AIC) and Bayesian information criterion (BIC) have been used to evaluate the quality of a model, which take into the account the trade-off between model complexity and model fit. Usually, the model with lower AIC/BIC values is preferred. For illustration purpose, we considered the following case, wherein simulated data was generated by a 3-state model. Assuming a modeler does not know the cardinality of fatigue state space, the fact that fatigue state space cardinality is discrete allows the modeler to search over a subset of possible numbers of states to find an appropriate (well-fitting) numeber. We followed this approach by parameterizing our model using 2-state, 3-state, and 4-state settings, respectively. The model settings can be found in the Appendix. The estimation results (log-likelihood) are on display in 
Figure 12
 and in 
Table 4
. As can be seen in 
Figure 12
, increasing the number of fatigue states from 2 to 3 resulted in a marked improvement in the likelihood, whereas increasing from 3 to 4 states led to no more gain. 
Table 4
 shows the AIC and BIC values for the different models, wherein the 3-state model yielded both the smallest AIC and BIC. To summarize, for a dataset generated by a 3-state model, the best estimates were achieved by a 3-state setting, which clearly outperformed a 2-state setting. Although a practitioner may not know the "true" number of underlying hidden states, he/she can experiment with different settings and select the setting with the smallest AIC/BIC value to achieve closest-totrue-model performance.


Discussions
We modeled the allocation of effort under mental fatigue as a DDC model with hidden and semi-Markov states. This model was based on reward/cost trade-offs, treated effort expenditure as capacity-limited (rather than resource-limited), and assumed that people behave rationally by seeking to maximize cumulative subjective values across the whole decision cycle. We posited that subjective value is influenced by mental fatigue and provided a way to calculate cumulative subjective values using some common assumptions. Moreover, we developed a maximum likelihood estimation procedure to identify model parameters -one-step subjective values and mental fatigue dynamics -from an agent's decisions and behavioral or physiological data. We tested the proposed estimation method with a simulated free choice n-back task composed of several blocks of trials. Simulated agents had to choose a task difficulty level for the upcoming block while taking into account the effects of mental fatigue. We fed simulation data to the estimation procedure and found high estimation precision in identifying model parameters. Further, we successfully reproduced some canonical findings from mental fatigue and decision making literature using predictions from the estimated model, including decreased task performance with increased time on task as well as increased feeling of fatigue, task re-engagement with additional performance incentives, and reduced marginal effects of further effort exertion with added incentives.
Below, we consider related work and summarize our approach's unique theoretical implications. We then envision some prospective applications that may benefit from our approach and also address some limitations of the proposed model.


Related Work
Some prior studies have addressed cognitive control and mental fatigue based on a reward/cost trade-off account. Those studies provided both empirical and theoretical insights into mechanisms that may account for mental effort exertion.
Here we compare the current work with prior studies to reveal the unique contribution of our approach.
Expected value of control (EVC) theory was proposed to explicate the principles of cognitive control allocation 
(Shenhav et al., 2013;
Shenhav et al., 2017)
. We sought to build on the EVC model by incorporating the influence of mental fatigue on effort allocation decisions. In the EVC model, the decision to be made regarding cognitive control is two-fold: the identity of control (i.e., what kind of cognitive control to engage) and the intensity of control. A rational agent needs to optimally adjust these control signals to maximize expected value. A computational study illustrated the EVC model in the context of a simulated flanker task based on a one-step control allocation problem 
(Musslick et al., 2015)
. The environment state was composed of sensory stimuli, which indicated the direction of the arrows in the flanker task. The control allocation decision of the agent was assumed to be based on the inferred state (the subjective representation of task stimuli), 
27
 and then the environment would emit an outcome (e.g., correct or incorrect response) determined by both the true state (the actual direction of the target arrow) and the subject's control decision (i.e., response). The update of automatic bias (e.g., the tendency to be influenced by flanking arrows rather than target arrows) was based on the difference between emitted outcomes (from the true state of the environment) and anticipated outcomes (from the inferred state of task stimuli), weighted by a learning rate. The model used by Musslick et al. involved a relatively short (trial to trial) time scale. In the current work, we focused on longer term subjective states (mental fatigue) that may influence effort allocation decisions. Further, differences in mathematical formulations used in the prior work and the current work can be found. Firstly, we considered the calculation of subjective values for an infinite horizon, which avoided the (possibly) overly simplified (onestep) formulation of subjective value. Secondly, we took a Bayesian brain perspective, modelling self-perception of mental fatigue as based upon the entire history of relevant observations and choices, rather than updating an inferred state (e.g., automatic bias) based on current perceptions and the difference between anticipated and actual outcomes as in 
Musslick et al.
 EVC theory has also been applied to the study of the influences of subjective states on cognitive control allocation, such as affect. More specifically, 
Grahek et al. (2020)
 studied the influence of affect on cognitive control by applying the EVC framework to simulated Stroop tasks. They parameterized the costs and rewards to build subjective values and based the analysis on the simulation results. In addition to the different research targets (i.e., affect versus fatigue), distinctions can be found between that work and the current model. We modeled mental fatigue as a hidden state that plays an important role in building subjective values and hidden state dynamics. 
Grahek et al.
 indirectly studied the influence of affect. For example, to study the influence of integral affect (i.e., a type of affect that arises from task performance and related incentives), Grahek et al. increased rewards for successful performance and compared the simulation results (e.g., task performance, willingness to exert cognitive control) to a model setting with smaller task rewards. Although that approach permitted the researchers to perform simulations and compare the differences between two model settings, it also raises questions such as how to determine the appropriate magnitude of task rewards? and how to address individual differences? (because different people may react differently to the different task reward values). By contrast, we provided a way to address those questions by estimating model parameters (subjective values and mental fatigue dynamics) from experimental data.
Estimation of the cost function using the EVC model was discussed in 
Musslick et al. (2018)
. They considered a onestep forward-looking formulation of EVC. In other words, cognitive control (e.g., identity and intensity) specified at time t results in some outcome that carries value at time t + 1. The optimal control policy should satisfy the first order condition by taking partial derivatives of EVC with respect to control. The derivatives contained two parts: one part was the derivative of the cost function (related to current step values), and the other part involved the derivatives of task accuracy (related to future values). Hence, by first order optimality condition, the cost function could be estimated via the derivatives of task accuracy, and those derivatives can be obtained from specific experimental designs (such as by manipulating task rewards and observing the corresponding changes in task accuracy to estimate the desired derivatives). In that work, a one-step forward-looking formulation of EVC and the implicit assumption that the values of outcomes did not depend on the current decision reduced the complexity of finding first order conditions. In the current work, the choice at time t affects future value by altering the agent's fatigue state; future value is the expected cumulative value for all decisions (at time t + 1, t + 2, ...) yet to come (rather than looking only oneperiod ahead). Our proposed estimation procedure proved able to deal with this relatively more complicated, nested form of subjective value function (hence, a recursive optimal effort allocation policy). 
Agrawal et al. (2020)
 proposed a model based on utility maximization to explain why people become (mentally) fatigued and bored. They proposed that fatigue and boredom bias human behavior toward more rewarding activities. In the case of fatigue, people may quit online cognitive operations in favor of offline computations (such as mental simulation) to improve the likelihood of gaining future rewards. In the case of boredom, people may quit the task at hand to search for more rewarding tasks. By specifying the agent's subjective preference (subjective utility) under different circumstances (different state-action pairs (s, a)), the model proposed by Agrawal et al. can be used to explain why and when fatigue and boredom occur. However, specifying an agent's subjective utilities is not a trivial undertaking. Our work aims directly at this issue: We estimate the agent's subjective values by their choices. 
28
 In other words, we do not assume the reasons behind task disengagement; we only assume that mental fatigue biases behavior by altering subjective values, and we can fit our model to data to quantify such fatigue-induced biases. In addition, our model treats mental fatigue states as partially observable, allowing for noise associated with fatigue measures. Our proposed estimation procedure can still identify underlying hidden fatigue dynamics with high precision based only on noisy (imprecise) measures.


Theoretical Implications
The power of learning from data endows the capability and potential of the proposed approach. We begin discussion of the model's implications by stressing (a) our model is an instance of a more general estimation methodology (structural estimation of POMDPs), which needs empirical data to function, and (b) the model is not limited to a specific form of subjective value function or fatigue dynamics; it invites researchers to test and compare their theories related to the constructions of subjective values as well as the dynamics of mental fatigue. In what follows, we provide some examples of how our model can contribute to the study of mental fatigue.
Distinguish rewards from costs. In the current model, the cost of mental effort c(s, a) and the perceived reward of successful task performance b(s, a) are modeled jointly in the one-step subjective value function as r(s, a) = c(s, a) − b(s, a). The current method will identify r(s, a); however, one could parameterize the cost function c(s, a) and the perceived reward function b(s, a) using evidence from empirical studies. The model could then estimate the effect of mental fatigue on the cost and perceived reward functions separately, which could help to understand the extent to which effort allocation decisions under mental fatigue stem mainly from changes in the perceived costs of expending effort, or the perceived rewards of expending effort, or some combination of both factors. Such an undertaking could shed light on the extent to which the perceived value of rewards changes under mental fatigue 
(Kelley et al., 2019)
.
Are subjective reports of mental fatigue objectively accurate? The measurement of mental fatigue usually includes both objective (e.g., task performance, physiological records) and subjective (e.g., self reports) indicators. Unfortunately, the two indicators do no not always align. Debates over the relative merits of the two indicators are common 
(Holtzer et al., 2017;
Sandry et al., 2014;
Völker et al., 2016)
. The modeling and estimation approach described here provides a possible way to address this issue: by fitting the model with objective measures (e.g., performance or physiological changes), one could compare the estimated dynamics of mental fatigue with subjective self-reports, which may help to specify the relationship between subjective and objective measurements of mental fatigue. It then will be interesting to examine for whom and under what circumstances subjective and objective indicators of mental fatigue cohere, and when they fail to cohere. We propose that research and theory on mental fatigue would benefit by identifying break points in coherence (i.e., circumstances wherein the two indicators diverge) and by identifying demographic, personality trait, or brain morphological factors that relate to coherence (or lack thereof) between subjective and objective indicators of mental fatigue.


Future Applications
Our modeling and estimation procedure to identify hidden fatigue dynamics and subjective values may prove useful for both theoretical and empirical studies of mental fatigue and effort allocation.
A perspective to deal with circularity. A crucial question raised by 
Botvinick and Braver (2015)
 regarded the mechanisms behind reward/cost trade-offs in explaining human behavior: Behavioral preferences are explained by subjective values, but subjective values, in turn, are usually inferred from behavioral preferences. The situation grows more complicated when mental effort carries costs: More effort leads to both more rewards and more costs. Hence, a clear pathway for obtaining subjective values is needed to break the circular reasoning identified above and thus ensure that "the assertion that choices maximize values becomes potentially falsifiable and thus truly scientific" (Padoa-Schioppa, 2011). Botvinick and Braver further claimed that one way to overcome the circularity is to leverage findings from neuroscience to consolidate the construction of subjective values. Relevant candidates include physiological indicators such as electroencephalography, pupil diameter, and neural activations related to effort allocation, subjective evaluation, and mental fatigue dynamics 
(Bartra et al., 2013;
Boksem et al., 2005;
Hopstaken et al., 2016;
Padmala & Pessoa, 2010;
Schmidt et al., 2012)
. One study used functional magnetic resonance imaging (fMRI) to test the hypothesis that incentives can enhance task performance by improving task information coding and maintenance 
(Etzel et al., 2016)
. Efficiency in decoding task information was significantly higher under incentive compared to no-incentive trials. Although neural activity correlated qualitatively with incentive evaluation, one question worth probing is: How much improvement can be achieved by introducing incentives? Or similarly, how much difference does an incentive make in term of subjective values? In the study of mental fatigue, the need for such quantitative analysis exists as well. For instance, as discussed previously, 
Hopstaken et al. (2015)
 found that the promise of rewards reversed the negative effects of mental fatigue and psychophysiological indicators associated with task disengagement. But how much reversal of such negative effects can be accomplished by offering additional rewards remained unexplained.
Our modeling and estimation procedure paves a new way for the rigorous and objective quantification of subjective values based on the behavioral, neural, physiological, and decision-making outputs of the decision maker. This quantification can be achieved by incorporating neuroscientific findings into the proposed framework. For example, in a task switching paradigm 
(Etzel et al., 2016)
, subjective value functions could be constructed via extracted fMRI patterns (in this example, fMRI activity corresponds to cue and early delay periods). If, for the simplest case, we could parameterize subjective values by a linear function of fMRI signals, then by estimating the corresponding parameters in the linear function, we may be able to build a quantitative relationship between choice preferences and their neural correlates via subjective values. Such parameterization enables one to build subjective value functions without undertaking the risk of circularity, and to simplify the estimation of subjective value functions by focusing on a few design parameters. In addition to the parameterization of subjective value functions, our framework features a customizable module for researchers to plug in the fatigue measurements they prefer (for the modeling of observation probability), which is a (conceptually) simple computation to implement. Yet it can be supercharged by neuroscientific advancements: More reliable fatigue measures lead to less noisy observations, which in turn enhance precision in the estimation of fatigue dynamics and subjective values. For example, recent years have witnessed the emergence of non-intrusive physiological measurements (such as smart wearables) of people's health status, which provide abundant observable data that could facilitate fatigue estimation. Researchers have already begun to realize the potential of smart phone or smart wearable data in assessment and monitoring of psychological states 
(Kodithuwakku Arachchige et al., 2021)
. Specifically, vital signs such as heart rate and heart rate variability, which may be tracked via smart watches or bands, are useful in predicting mental fatigue (H. 
Luo et al., 2020)
. Further, eye blink data can be collected using smart glasses and may also contribute to detecting mental fatigue 
(Horiuchi et al., 2018)
.
Our model may take the advantage of aforementioned technology breakthroughs and help researchers answer quantitative questions such as "how much performance gain can be achieved for a given incentive?" Lastly, our model is capable of describing within or across individuals variations in the mapping from neural correlates to subjective values, which will be discussed in the next section. Simply put, with a sufficient amount of data, our model can be fitted separately for different individuals as well as groups of people, which may facilitate the study of individual level and group level perceptions of subjective value.
Individual differences. Individuals differences in personality traits 
(Braem et al., 2013;
Jimura et al., 2010)
, age 
(Ennis et al., 2013)
, and clinical disorders 
(Marx et al., 2013)
 are likely to impact subjective values 
(Westbrook & Braver, 2015)
. Differences in subjective values may predict differential willingness to allocate mental effort in daily life 
(Westbrook et al., 2013)
. One study of cognitive control using a 2-step decision making model found significant individual differences in the the tendency to incorporate goal-related contextual information in decision making 
(Otto et al., 2015)
. Such individual differences likely play a role in effort allocation decisions as well. Age is another likely moderator of mental effort allocation; it is possible that aging alters the perceived costs of expending mental effort 
(Westbrook et al., 2013)
. In the study of mental fatigue, individual perceptions play an important role as well. Evidence has suggested that older people may be influenced by mental fatigue in a different manner compared to young people, and older people may fatigue more quickly and suffer greater performance decrements compared to young people 
(Arnau et al., 2017)
.
Our model provides a way to study the influence of such individual differences: The estimation procedure can identify the one-step subjective values (and thus, reward function and cost function parameters) and fatigue dynamics for each individual or group. By comparing estimation results across individuals or groups, one could attempt to quantify the influence of the individual difference of interest. Furthermore, a counterfactual analysis (i.e., comparing what actually happened against what would have happened under different conditions) could be used to predict individual differences in reward/cost sensitivity 
(Braem et al., 2013;
Engelmann et al., 2009)
. Our model is able to easily simulate changes in incentives and observe the consequences of such changes, which could then be tested (verified) in experiments with human subjects.
Perceptions of effort and mental fatigue may be important also for understanding some clinical disorders. The perceived costs of expending effort may relate to specific clinical conditions. People with depression or schizophrenia may experience more effort related costs compared to others 
(Westbrook et al., 2013)
. Fatigue descriptions in clinical practice are various and have different emphases in different contexts: some focus on both physical fatigue and mental fatigue (e.g. chronic fatigue syndrome, see 
Pattyn et al. (2008)
 and 
Shen et al. (2006)
) whereas others may stress mental fatigue in particular (e.g., insomnia, see 
Pattyn et al. (2008)
); some can be alleviated by sleeping 
(Mairesse & Neu, 2016)
 whereas others are more acute and may not be improved by rest 
(Hossain et al., 2003)
. Furthermore, the intensity of perceived fatigue may differ across individuals with underlying clinical conditions. As mental fatigue is a multi-faceted construct, it is unlikely that one particular measure can precisely and comprehensively capture the a person's level of mental fatigue 
(Pattyn et al., 2008)
.
Our model introduces a novel way for clinical studies to approach effort expenditure and mental fatigue. In addition to having the capacity to incorporate relevant physiological and self-report measures of mental fatigue, our model infers subjective values from behavioral choices. In clinical conditions that implicate effort deficits, analysis of subjective values has proved successful in predicting symptoms such as substance abuse, obesity, and problem gambling 
(Westbrook & Braver, 2015)
. In the evaluation of mental fatigue in clinical populations, a "transactional model" of fatigue has been proposed to measure levels of mental fatigue based on the patient's experience 
(Pattyn et al., 2008
). The proposed model suggests a practical implementation of this idea by fitting our mental fatigue model to each individual patient, resulting in a unique clinical profile capturing personal effort exertion willingness and changes in willingness due to mental fatigue. The potential exists for this approach to help tailor treatments to individuals for mitigating effort-and fatiguerelated decrements.
Controllability and task performance. It has been proposed that work performance depends on both how demanding a task is and the degree of controllability the person has over his or her activities 
(Hockey, 2011;
Hockey & Earle, 2006)
. Empirical results have suggested that people may sustain relatively high levels of work performance without reporting fatigue if they are allowed to arrange the work at their discretion 
(Frese, 1989;
Karasek Jr, 1979;
Wall et al., 1996)
. In a more recent study, Hockey and Earle built a simulated office work environment wherein the workload was characterized by both time pressure and controllability (of task schedule). Under high workload, only the low controllability group exhibited negative effects on work performance and fatigue.
Our model provides a way to study individual preferences for Demand × Control interactions. An adapted free choice paradigm permits an agent to allocate effort by distributing workloads to specific periods of time. Assuming that a decision maker behaves rationally and thus, given a defined workload and a specific time span, optimally allocates effort based on subjective values, researchers would be able to quantify how subjective values change as the agent grows more fatigued and how the agent maintains a balance between work progress and the negative effects of mental fatigue. This balance is important because it marks the optimal effort allocation strategy (for the agent) and can be explained by a compensatory control model 
(Hockey & Earle, 2006)
 such that the discrepancy between work goals and effort exertion are reconciled. The interpretation from our model would be that the agent adjusts his or her fatigue state by altering the allocation of effort, thereby keeping fatigue levels in an acceptable range with economically optimal trade-offs between costs and rewards.
Dissociation of choice dimensions. Dissociability is an important concept in decision making and neuroeconomics. Both the delay of rewards and the uncertainty of receiving rewards conspire to reduce subjective values. Generally speaking, more delayed rewards and less certain rewards are valued less than their sooner or more certain counterparts. How can one be certain whether delay or uncertainty is responsible for an observed discounting of rewards? Further, how might we distinguish discounts induced by effort from discounts induced by delay or uncertainty? If these discount factors cannot be dissociated, then effort-based decision making may be just another form of delay-or uncertainty-based decision making 
(Westbrook & Braver, 2015)
. Researchers have designed different experimental paradigms to dissociate the costs of effort from the costs from delay or uncertainty. In the current work, we have introduced fatigue as another potential factor that may serve to discount subjective values. Moreover, although not addressed in the current model, factors other than fatigue could influence the subjective evaluation of task values, including such as negative moods or boredom 
(Chiew & Braver, 2011;
Pattyn et al., 2008;
Pessoa, 2008;
van Steenbergen et al., 2012)
.
As the number of the variables that influence subjective values increases, it becomes harder to dissociate their effects by pure experimental design techniques. Our model opens the door to dissociate effects of different variables via mathematical optimization of the likelihood of data: The variables of interest can be included in the reward/cost functions and estimated. For example, agents may manifest both "overload" (limited cognitive capacity) or "underload" problems (often described as boredom) 
(Hancock & Desmond, 2001)
. It has been argued that although both types of problems represent a form of fatigue (sometimes described as active fatigue and passive fatigue, respectively), they have different mechanisms. It may be informative to examine the discounting mechanisms associated with overloads and underloads -by parameterizing subjective value as a function of both passive and active fatigue -to understand how they influence subjective values that may explain the agent's effort allocation behaviors. We intend our model to be used in the future research to untangle the processes underlying the outcomes of mental fatigue.


Limitations
Simplifying assumptions revisited. In the Simulated Nback Tasks with Changing Fatigue section (above), we illustrated our method via a simulated n-back task under the assumption that choosing to perform the harder task hastens fatigue (which is supported by prior studies, e.g., 
Blain et al., 2016)
. This assumption was linked to the idea that the agent earns the reward associated with the task only if their performance surpasses a threshold presumed to entail some degree of mental effort (particularly when the more difficult task was chosen). If the agent expends little or no effort on the difficult task, then it is likely that no reward is earned; the simpler task would have been the more rational choice. Nevertheless, human agents do not always make rational decisions. Another assumption we made was that choosing to perform easier tasks restores mental fatigue, though this assumption also may not hold in all circumstances. For example, tasks that do not entail much mental effort, instead of restoration, may be prone to elicit boredom. We cannot rule out the possibility that agents will grow bored, rather than or in addition to mentally fatigued, when performing n-back tasks. In fact, a previous study of reward sensitivity and boredom found it hard to fully decouple fatigue and boredom 
(Milyavskaya et al., 2019)
.
To be sure, our model does not present an exhaustive analysis for each possible scenario. The aforementioned assumptions were adopted only for illustrative purposes and are based on prior evidence consistent with the assumptions. Such assumptions influence the ways we parameterized fatigue dynamics and subjective value functions, but the same estimation procedure would still apply to obtain those estimates. Furthermore, one could also fit the data under different assumptions to see which assumptions best explain observed behaviors, thereby providing a way to test the validity of the assumptions. This consideration represents another example of how researchers can use our model and estimation methods in future work to advance research and theory on mental fatigue.
Concerns arising from the rationality assumption. Our proposed model may serve many future studies of mental effort and mental fatigue, though the model carries the inherent liabilities of the reward/cost trade-off framework. One concern is the assumption that people behave rationally 
(Rust, 1994)
. In many scenarios, people may act based on local contexts by comparing available options rather than evaluating all possible options. As a result, the relative values of different options may change with the immediate task environment 
(Delgado et al., 2011;
Tversky, 1969)
. In our proposed model, the agent is assumed to evaluate the subjective values for each option and select the option with the highest subjective value (i.e., act independent of bias induced by local contexts). Another potential issue is that people may have difficulty evaluating the subjective values of states that are not currently occupied 
(Dayan, 2012;
Loewenstein & O'Donoghue, 2004)
. For example, a person may underestimate the difficulty of being on a diet when he or she is currently not hungry. If a relative incapability to predict non-occupied states is a general principle in mental effort allocation, then our proposed model may not be able to provide satisfying explanations or predictions for people's behaviors, because we assumed that human agents are rational and can objectively evaluate the values of future outcomes rooted from current state and choice selection.
Affect and effort allocation. Our current work focused on the "cognitive" side of mental fatigue and its effects, leaving the "affective" side relatively untouched. Emotions (or affects, used interchangeably from here on) are ubiquitous and play an important role in human decision making, whether or not people are aware of their influence. However, how emotions influence decision making is still under debate. Different theories have been proposed. For example, some researchers have posited a valence-based approach (to what extent an emotion is experienced as positive/negative matters 
(Han et al., 2007;
Loewenstein & Lerner, 2003)
) whereas others have proposed an arousal-based approach (the intensity of emotions matters 
(Kaufman, 1999;
Sohn et al., 2015)
). Some theorists believe a two-dimensional description of emotion is far from enough 
(Mellers et al., 1998)
 and have proposed an appraisal-tendency framework, which posits that emotion is a multi-dimensional construct and carries motivational factors that bias decision making depending on both qualitative properties (which type of emotion) and quantitative properties (the intensity of such emotion). We notice that, while being attributed to different reasons/mechanisms, different theories of emotion share a common feature: emotions carry value that can influence decision making. 
Lazarus and Lazarus (1991)
 further argued that different emotions are related to different "themes" in assessing the value of events.
Following the assumption that emotions carry value, our model may prove useful for studying the influence of emotions on decision making. The relevant state space in the model can incorporate both fatigue and affective states. As a result, subjective values would be a function of both fatigue and affective states; The temporal dynamics would describe the joint transition of those two states across time. Implementing such a model is not a trivial undertaking and was not the main focus of our present work, but the role of affect in shaping subjective value represents a novel route for future research to build on the model we have proposed. Another promising avenue for future work may be to consider compensatory mechanisms that help to sustain good performance under mental fatigue. A similar compensatory mechanism has been proposed to understand high performance in the context of cognitive and emotional stressors (e.g., 
Pavlidis et al., 2016)
, and it seems reasonable to assume that similar mechanisms exist to combat mental fatigue. These ideas represent possible applications of our model in the study of joint effects of mental fatigue and affect on decision making. Because our approach is an instance of the structural estimation of POMDPs, one would need to deliberately design model parameters and experiment settings to unveil the power of the model (because it is meaningless to train a highly mis-specified model).
If, as discussed above, affect carries value, then some behaviors considered "irrational" by outsiders (not the decision maker) may actually be rational to the decision maker him/herself, in the sense that they contribute to subjective value. Our model is capable of dealing with hidden states, and thus may help rationalize decision making behaviors by quantifying the values of such hidden values.
Modeling of temporal delay discounting. Delay discounting, which is related to but potentially distinct from effort discounting, has long been of interest to researchers in the study value-based decision making. Delay discounting accounts for the phenomena whereby a distal reward (to be obtained in the future) is less valuable compared the same amount of reward that can be obtained right now. A common finding, which is referred to as the amount effect, is that larger subjective values will be discounted less than smaller values 
(Green et al., 2013;
Thaler, 1981)
. Individual differences have also been observed in delay discounting rates: People who perceive higher costs tend to more heavily discount future values.
In the current work, we assumed that subjective values are discounted by β, which implies the proportionality of delay discounting does not depend on the amount of the subjective value. This assumption may not be appropriate for modeling future subjective values (i.e., it does not adequately account for the amount effect). And it seems to be reasonable to relate such amount effects to delay discounting mechanisms. Furthermore, recent studies have found that temporal delays may discount subjective value hyperbolically 
(Frederick et al., 2002;
Green & Myerson, 2004;
Laibson, 1997)
. In comparison, our model assumes an exponential discounting mechanism, suggesting that the discounting proportion of subjective values is determined by a discount factor β to the power of the duration of temporal delay t (β t ). A worthwhile future research direction would be to incorporate different delay discounting mechanisms into the proposed model and compare which mechanism fits data better.


Conclusion
We modeled the effects of mental fatigue on effort allocations based upon a reward/cost trade-off account. We posited that mental fatigue influences effort allocation decisions by altering subjective values. We provided an estimation method to identify mental fatigue dynamics and subjective values from experimental data. Our proposed model successfully verified mental fatigue related phenomena such as performance drops, task disengagement, and re-engagement with additional incentives. Further, our work offers the potential for advancing understanding of human effort allocation under mental fatigue, including estimation of individual differences, differentiating clinical conditions associated with compromised fatigue manifestations, investigations of neural underpinnings corresponding to mental fatigue and its influ-ences on subjective value representations, and dissociability studies to isolate the effects of mental fatigue from multiple other determinants of subjective value. Collectively, our work, rooted in extant decision making theories and prior studies of mental fatigue, unleashes a promising future of quantitative study of mental fatigue by harnessing the advantages of both empirical research and mathematical methods.


Table B2
Observation probabilities P(z|s) (values in the parentheses are the estimates from the 3-state model). z = 1 z = 2 z = 3 z = 4 s = 1 0.1 (0.10) 0.2 (0.20) 0.3 (0.30) 0.4 (0.40) s = 2 0.2 (0.19) 0.3 (0.29) 0.4 (0.41) 0.1 (0.11) s = 3 0.4 (0.41) 0.3 (0.30) 0.2 (0.20) 0.1 (0.09)


Table B3
Sojourn time parameters (values in the parentheses are the estimates of the 3-state model). 
Table cells
 with no value indicates those scenarios will not occur. s t+1 = 1 s t+1 = 2 s t+1 = 3 a t = 1 0.3 (0.29) 0.8 (0.83) a t = 2 -0.7 (0.69) 0.2 (0.20) a t = 3 -0.4 (0.38) 0.4 (0.41) fixed to 4 (according to experiment design, not to be estimated). 1 a = 1, 3 a = 2, 6 a = 3, where c p denotes the (predefined) performance criteria required to receive incentives. 5. One-step subjective value parameters θ 3 = {θ 3,1 , θ 3,2 } = {2.5, 0.5}.
We used the aforementioned model parameters to generate a sample data set containing 2,000 sample paths with 80 decision epochs for each sample path. Then we fit the models assuming 2-, 3-, and 4-state settings, respectively.
Appendix C Proofs Proof of Theorem 1. The proof is by induction as in 
Chang et al. (2020)
 and 
Smallwood and Sondik (1973)
. Let ζ t+1 = ζ ′ , ϵ t+1 = ϵ ′ . Assume g t+1 (ζ ′ , ϵ ′ ) = V t+1 (x ′ , ϵ ′ ), then at time t, σ(x, a, z ′ ) V t+1 (λ(x, a, z ′ ), ϵ ′ )dµ(ϵ ′ ) ,
= V t (x, ϵ).
where the second equation is by P(z ′ |ζ, a) = σ(x, a, z ′ ) and
x ′ = λ(x, a, z ′ ). □
Identification of fatigue dynamics. We explain the identification of the dynamics of fatigue states and their duration times as follows. Such dynamics is defined by {P θ D (s ′ , τ ′ , z|s, τ, a) : s, s ′ ∈ S, τ, τ ′ ∈ D, a ∈ A} (parameterized by θ D ). Both reduced form observation probability and updated Bayesian belief depend on P θ D and are denoted as σ θ D , x t,θ D , respectively. Given that
σ θ D (z t+1 , x t,θ D , a t ) a function of θ D =P(z t+1 |ζ t , a t )
from data , whereP(z t+1 |ζ t , a t ) is a function of data, one would expect that θ D could be identified by matching σ θ D with empirical probabilitiesP(z t+1 |ζ t , a t ). To test this idea, consider the first period data {x 0 , a 0 , z 1 }:
σ θ D (z 1 , x 0 , a 0 ) = s 1 ,τ 1 s 0 ,τ 0 x 0 (s 0 , τ 0 )P θ D (s 1 , τ 1 , z 1 |s 0 , τ 0 , a 0 ) = s 0 ,τ 0 x 0 (s 0 , τ 0 )P θ D (z 1 |s 0 , τ 0 , a 0 ) =P(z 1 |x 0 , a 0 )
(9)
The issue is that Equation (9) is not enough to uniquely determine P(s t+1 , τ t+1 , z t+1 |s t , τ t , a t ): It is possible that there exist θ D θ ′ D and (s t+1 , τ t+1 ) such that P θ D (s t+1 , τ t+1 , z t+1 |s t , τ t , a t ) P θ ′ D (s t+1 , τ t+1 , z t+1 |s t , τ t , a t ) but P θ D (z t+1 |s t , τ t , a t ) = P θ ′ D (z t+1 |s t , τ t , a t ). In this case, consider two periods of data {x 0 , a 0 , z 1 , a 1 , z 2 }. We show that for two dynamics of fatigue θ D , θ ′ D :
θ ′ D = θ D ⇐⇒ x 1,θ D = x 1,θ ′ D ,
(10)
where "⇐⇒" stands for "if and only if". "=⇒": is trivial to see. "⇐=": Since
x 1,θ D (s, τ) = s 0 ,τ 0 P θ D (s 1 = s, τ 1 = τ, z 1 |s 0 , τ 0 , a 0 )x 0 (s 0 , τ 0 ) σ θ D (x 0 , a 0 , z 1 ) ,
where x 0 is given and σ θ D (x 0 , a 0 , z 1 ) = σ θ ′ D (x 0 , a 0 , z 1 ) = P(z 1 |ζ 0 , a 0 ), ∀x 0 , a 0 , z 1 . Thus, if x 1,θ D = x 1,θ ′ D , then θ D = θ ′ D . Furthermore, we claim that:
x 1,θ D = x 1,θ ′ D ⇐⇒ σ θ D (x 1,θ D , a 1 , z 2 ) = σ θ ′ D (x 1,θ ′ D , a 1 ,
z
2 ). (11) "=⇒": holds because x 1,θ D = x 1,θ ′ D =⇒ θ D = θ ′ D (Equation.(10)). "⇐=": holds because 
1 , τ 1 , a 1 )
x 1 (s 1 , τ 1 ).
σ(x 1 , a 1 , z 2 ) = s 2 ,τ 2 s 1 ,τ 1 P(s 2 , τ 2 , z 2 |s 1 , τ 1 , a 1 )x 1 (s 1 , τ 1 ) = s 1 ,τ 1 P(z 2 |s
Note that P θ D (z 2 |s 1 , τ 1 , a 1 ) = P θ ′ D (z 2 |s 1 , τ 1 , a 1 ) is guaranteed by first period of data. If the second period of data is also matched, i.e.,
σ θ D (z 2 , x 1,θ D , a 1 ) = σ θ ′ D (z 2 , x 1,θ ′ D , a 1 ) =P(z 2 |ζ 1 , a 1 ), then x 1,θ D = x 1,θ ′ D .
Hence, by matching two periods of data, Eq (10), (11) hold and P θ D (s ′ , τ ′ |s, τ, a) can be uniquely determined, or identified. □ Identification of one-step subjective values. We illustrate the identification of one-step subjective values in the case of ϵ being multivariate i.i.d Gumbel. Hence the CCP has the closed form:
π(a|x) = exp Q(x, a) a ′ exp Q(x, a ′ )
.
Consequently, we have the mapping from the difference in Q(x, a) (compared to a reference action a 0 ) to the difference in CCP (compared to a reference action a 0 ): π(a|x) π(a 0 |x) = exp(Q(x, a) − Q(x, a 0 )).
Note that:
Q(x, a 0 ) = r(x, a 0 ) + β
z ′ σ(x, a 0 , z ′ ) log a ′ exp Q(λ(x, a, z ′ ), a ′ ) = r(x, a 0 ) + β z ′ σ(x, a 0 , z ′ )Q(λ(x, a, z ′ ), a 0 ) + β z ′ σ(x, a 0 , z ′ ) log a ′ exp Q(λ(x, a, z ′ ), a ′ )
− Q(λ(x, a, z ′ ), a 0 ) , by the fact that log N i=1 exp(x n ) = c + log N i=1 exp(x n − c). Since the dynamics of fatigue state and its duration are identifiable, {x t } t>0 can be calculated for each sample path and π(a|x) is obtainable from the data. Consequently,
z ′ σ(x, a 0 , z ′ ) log a ′ exp Q(λ(x, a, z ′ ), a ′ ) − Q(λ(x, a, z ′ ), a 0 ) = z ′ σ(x, a 0 , z ′ ) a ′
π(a ′ |λ(x, a, z ′ )) π(a 0 |λ(x, a, z ′ )) can be estimated from data (note x ′ = λ(x, a, z ′ )). Since the subjective value sfor a reference choice {r(s, a 0 ), s ∈ S} is known, the expected cumulative subjective value function Q(x, a 0 ), x ∈ X can be uniquely determined by contraction mapping theorem (and so do Q(x, a), a a 0 , by using Eq. (12)). To find subjection values r, we simply use:
r(x, a) =Q(x, a) − β z ′ σ(x, a, z ′ ) log a ′ exp Q(λ(x, a, z ′ ), a ′ ),
where r(x, a) = s x(s)r(s, a). Hence, r(s, a) can be identified by solving a set of equations containing different beliefs. □
Figure 4
4
Structure of proposed model. Arrow lines show directional statistical dependence. The hidden fatigue state s persists for a (random) sojourn time d i , i = 0, 1, .... At each time, an observation z t is obtained. The agent's subjective value of performing tasks with effort level a is perturbed by a random variable ϵ t (a). The change in fatigue state s is affected by effort allocation choice a (at τ


, including: Linear: c(s, a) = ksa; Hyperbolic: c(s, a) = 1 1−ksa ; Parabolic: c(s, a) = k(sa) 2 ; Exponential: c(s, a) = e ksa ;


Figure 8
8
Task performance (measured in d-prime) decreased as time on task increased as observed in prior work (adapted from(Hopstaken et al., 2015, Figure 3, 2-back task) and our model predictions.25  The orange dashed line represents the findings from
Hopstaken et al. (2015)
 whereas the blue solid line shows our model predictions.


Figure 11
11
Estimation performance under different values of β. Blue solid line shows the model performance (in terms of loglikelihood) with respect to different β. Orange dashed line shows the maximum element-wise percentage difference between estimates under different β and ground truth. parametersθ 3 and their true values θ 3 change with respect to β.


′ |ζ, a) V t+1 (x ′ , ϵ ′ )dµ(ϵ ′ )


Table 4
4
AIC, BIC of different models for simulated data. We calulcated AIC and BIC values for estimated models with different numbers of hidden states. Note that for the different models, the number of parameters required to describe the model is different.
S = 2
S = 3
S = 4
# parameters
11
20
32
AIC
2,740,992 620,613 621,281
BIC
2,741,101 620,812 621,601


Table B3
B3
summarizes the parameter values used to define those Binomial distributions for each choice a t and each future state s t+1 . 4. External (performance-dependent) monetary rewards are the same as used in the manuscript.

incentive(a; c p ) =
           


In the context of a Bayesian brain, a generative model refers


More details pertaining to the belief updating process can be found in the Appendix.10 The proofs of these existing theoretical results can be found in
Chang et al. (2020)
.11 In practice, one stops at a finite T once some termination criterion is met.12 The relationship between the expected cumulative subjective value function and CCP have been discussed widely in past work
(Chang et al., 2020;
McFadden, 1980;
Rust, 1994)
.


Usually x 0 can be obtained from self-reports. Numerical examples also show that the influence of x 0 on estimation results is increasingly negligible as the number of decision epochs T increases (e.g., see
Chang et al. (2020)
).14 The values of |S|, |D|, β and distribution µ can be treated as design parameters and a practitioner can test different options on these parameters for a best fit.15 Theoretically, we should jointly maximize θ D , θ R for the optimal likelihood function. However, the joint estimation is computationally expensive. In practice, a partial estimation (first estimating θ D and then estimating θ R based on the estimator of θ D ) -such as our proposed procedure -is widely used and usually yields good performance (i.e., consistent, asymptotically normally distributed estimators)
(Cox, 1975;
Rust, 1994)
.


In an actual experiment, fatigue measures could include electroencephalography, electrocardiography, performance metrics, etc. Here, in a simulated environment, the fatigue measures were composed of random variables stochastically dependent on hidden fatigue states.


In human subjects, task difficulty can be linked to effort with careful experimental design. For example, subjects can be informed that incentives will be earned only if certain performance standards are met. Hence, choosing a task that is beyond one's capability to achieve (i.e., the performance standard cannot be met) is irrational because the rewards are unobtainable. Such an experiment design helps guide subjects to choose task difficulty levels that match the effort they are willing to exert.


In a flanker task, subjects indicate which direction a target arrow points, with the target arrow surrounded by other non-target arrows (which may aim in a different direction than the target). The nontarget (flanking) arrows may distract attention -making subjective representation of task stimuli noisy and inaccurate -and may elicit an incorrect response to the target.


The relationship between subjective preference and choices has been considered in the theory of revealed preferences, which states that humans' choices are the best indicator of their preferences, see
Samuelson (1938)
.








Appendix A Detailed Belief Updating Process Here we provide more details of Bayesian belief update. Let X be the (finite dimensional) probability simplex in R |S ×D| and x t ≜ {P(s t , τ t |ζ t ), ∀(s t , τ t ) ∈ S × D} ∈ X be the Bayesian belief, which is the posterior distribution over possible fatigue states and its duration times (s t , τ t ) given history ζ t . Then, ∀t, x t ∈ X, the size of belief x t remains constant and does not grow to infinity. To see this, for a given belief x t at time twhich is a matrix of size S × D (S rows and D columns) -the updated (posterior) belief x t+1 at time t + 1 also has the same size as x t , where the belief update is given by:
where the denominator is
is called the reduced form observation probability 
(Chang et al., 2020)
. We denote this updating procedure by x t+1 = λ(x t , a t , z t+1 ). The numerator of Equation (8) can be further factorized by considering τ t = 0 and τ t > 0:
.
The updated belief relies on the current state s t and time left τ t in s t . If τ t = 0, then the current fatigue state s t = s transitions to a different state s t+1 = s ′ (s ′ s), generating a new sojourn time τ t+1 and an observation z t+1 according to the environment state dynamics. If τ t > 0, then the current fatigue state persists (s t+1 = s t ). To find the probability associated τ t+1 = τ, we use the probability associated with τ t = τ + 1 because τ t+1 = τ t − 1 when τ t > 0. The σ function in the Equation (8) serves as a regulator for the sum of all the elements of x t+1 equals 1.


Appendix B Robustness Analysis Experiment ofthe Number of Fatigue States
We designed a numerical experiment and generated data assuming 3 true fatigue states: state 1 (not fatigued state), state 2 (medium fatigue state) and state 3 (fatigued state). Assuming the number of fatigue states is not known in advance, we


Table B1
State transition probabilities for different choices (values in the parentheses are the estimates from the 3-state model). started estimation from 2 fatigue states, then 3 fatigue states and so on. Specifically, we began with the "ground truth" model to generate synthetic data and then used this dataset to recover the model parameters wherein the number of fatigue states was an unknown parameter.
1. The state transition probabilities are shown in 
Table B1
. Note that we still assume that easier tasks lead to faster recovery as in Section Simulated N-back Tasks with Changing Fatigue. When choosing and performing a = 1 (1-back) task, the fatigue state will improve. When choosing and performing a = 2, 3 (2, 3-back) task, fatigue state will deteriorate, and harder tasks lead to a higher probability of deterioration. For example, in 
Table B1
(a), when the current state is either 1 or 2, and the choice is to select 1 (1-back, easiest), the state transition can only lead to a better state (not fatigued). And when the current state is 3, choosing and performing the 1-back task leads to less fatigued state (state 1, 2). Similar rules apply in 
Table B1
(b)-(c). 2. The observation probabilities P(z|s) are shown in 
Table  B2
. 3. Sojourn time distribution parameters are given by Table B3, wherein the sojourn time distribution takes the form P(τ t+1 |s t+1 , a t , τ t = 0). For illustration purpose, we assumed that sojourn times follow Binomial distributions with two parameters: a probability parameter and the total number of trials, the latter of which is
 










Apprenticeship learning via inverse reinforcement learning




P
Abbeel






A
Y
Ng




10.1145/1015330.1015430








1












Identifying the discount factor in dynamic discrete choice models




J
H
Abbring






Ø
Daljord








Quantitative Economics




11


2
















The temporal dynamics of opportunity costs: A normative account of cognitive fatigue and boredom




M
Agrawal






M
G
Mattar






J
D
Cohen






N
D
Daw












bioRxiv








Dynamic discrete choice structural models: A survey




V
Aguirregabiria






P
Mira








Journal of Econometrics




156


1
















The interconnection of mental fatigue and aging: An eeg study




S
Arnau






T
Möckel






G
Rinkenauer






E
Wascher








International Journal of Psychophysiology




117
















A survey of inverse reinforcement learning: Challenges, methods and progress




S
Arora






P
Doshi




arXiv:1806.06877










arXiv preprint








Motivational determinants of risktaking behavior




J
W
Atkinson








Psychological Review




64


6p1


359














Identification and semiparametric estimation of a finite horizon dynamic discrete choice model with a terminating action




P
Bajari






C
S
Chu






D
Nekipelov






M
Park








Quantitative Marketing and Economics




14


4
















Self-efficacy: Toward a unifying theory of behavioral change




A
Bandura








Psychological Review




84


2


191














The valuation system: A coordinate-based meta-analysis of bold fmri experiments examining neural correlates of subjective value




O
Bartra






J
T
Mcguire






J
W
Kable








Neuroimage




76
















Statistical inference for probabilistic functions of finite state markov chains




L
E
Baum






T
Petrie








The Annals of Mathematical Statistics




37


6
















A maximization technique occurring in the statistical analysis of probabilistic functions of markov chains




L
E
Baum






T
Petrie






G
Soules






N
Weiss








The Annals of Mathematical Statistics




41


1
















Dynamic programming




R
Bellman








Science




153


3731
















The feeling of effort during mental activity




E
Bijleveld








Consciousness and Cognition




63
















Neural mechanisms underlying the impact of daylong cognitive work on economic decisions




B
Blain






G
Hollard






M
Pessiglione








Proceedings of the National Academy of Sciences




113


25
















Effects of mental fatigue on attention: An erp study




M
A
Boksem






T
F
Meijman






M
M
Lorist








Cognitive Brain Research




25


1
















Mental fatigue, motivation and action monitoring




M
A
Boksem






T
F
Meijman






M
M
Lorist








Biological Psychology




72


2
















Motivation and cognitive control: From behavior to neural mechanism




M
Botvinick






T
Braver








Annual Review of Psychology




66














Punishment sensitivity predicts the impact of punishment on cognitive control




S
Braem






W
Duthoo






W
Notebaert








PLOS One




8


9


74106














The intensity of motivation




J
W
Brehm






E
A
Self








Annual Review of Psychology




40


1
















Optimal policies for partially observable markov decision processes (tech. rep




A
R
Cassandra












Brown Univ












Dynamic discrete choice estimation with partially observable states and hidden dynamics




Y
Chang






A
Garcia






Z
Wang




















Positive affect versus reward: Emotional and motivational influences on cognitive control




K
S
Chiew






T
S
Braver








Frontiers in Psychology




2


279














Inverse reinforcement learning in partially observable environments




J
Choi






K.-E
Kim








Journal of Machine Learning Research




12
















Neurocomputational mechanisms underlying subjective valuation of effort costs




T
T
Chong






.-J
Apps






M
Giehl






K
Sillence






A
Grima






L
L
Husain






M








PLOS Biology




15


2


1002598














A depleted mind feels inefficacious: Ego-depletion reduces selfefficacy to exert further self-control




J
T
Chow






C
M
Hui






S
Lau








European Journal of Social Psychology




45


6
















Partial likelihood




D
R
Cox








Biometrika




62


2
















How to set the switches on this thing. Current Opinion in Neurobiology




P
Dayan








22














Decision theory, reinforcement learning, and the brain




P
Dayan






N
D
Daw








Cognitive, Affective, & Behavioral Neuroscience




8


4
















Dynamics in typewriting performance reflect mental fatigue during real-life office work




M
De Jong






A
M
Bonvanie






J
Jolij






M
M
Lorist








PLOS One




15


10


239984














Decision making, affect, and learning: Attention and performance xxiii




M
R
Delgado






E
A
Phelps






T
W
Robbins








OUP


Oxford












A political economy model of congressional careers




D
Diermeier






M
Keane






A
Merlo








American Economic Review




95


1
















The assessment of fatigue: A practical guide for clinicians and researchers




A
J
Dittner






S
C
Wessely






R
G
Brown








Journal of Psychosomatic Research




56


2
















Modeling cognitiveaffective dynamics with hidden markov models




S
D'mello






A
Graesser








Proceedings of the Annual Meeting of the Cognitive Science Society


the Annual Meeting of the Cognitive Science Society






32












Classification of human sleep stages based on eeg processing using hidden markov models




L
Doroshenkov






V
Konyshev






S
Selishchev








Biomedical Engineering




41


1


25














Inverse optimal control with linearly-solvable mdps




K
Dvijotham






E
Todorov








Proceedings of the 27th International Conference on International Conference on Machine Learning


the 27th International Conference on International Conference on Machine Learning


















What is a hidden markov model?




S
R
Eddy








Nature Biotechnology




22


10
















Combined effects of attention and motivation on visual task performance: Transient and sustained motivational effects




J
B
Engelmann






E
Damaraju






S
Padmala






L
Pessoa












Frontiers in Human Neuroscience, 3, 4.








Role of working-memory capacity in cognitive control




R
W
Engle








Current Anthropology




51


S1
















The impact of age and motivation on cognitive effort: Implications for cognitive engagement in older adulthood




G
E
Ennis






T
M
Hess






B
T
Smith








Psychology and Aging




28


2


495














Reward motivation enhances task coding in frontoparietal cortex




J
A
Etzel






M
W
Cole






J
M
Zacks






K
N
Kay






T
S
Braver








Cerebral Cortex




26


4
















The effect of task demand and incentive on neurophysiological and cardiovascular markers of effort




S
H
Fairclough






K
Ewing








International Journal of Psychophysiology




119
















A metabolic measure of mental effort




S
H
Fairclough






K
Houston








Biological Psychology




66


2
















Subjective probability and decision under uncertainty




N
T
Feather








Psychological Review




66


3


150














Success probability and choice behavior




N
T
Feather








Journal of Experimental Psychology




58


4


257


















A
J
Finley






D
Tang






B
J
Schmeichel








Social Psychology










Sweet nothings








Guided cost learning: Deep inverse optimal control via policy optimization




C
Finn






S
Levine






P
Abbeel








Proceedings of the 33rd International Conference on International Conference on Machine Learning


the 33rd International Conference on International Conference on Machine Learning


















Time discounting and time preference: A critical review




S
Frederick






G
Loewenstein






T
O'donoghue








Journal of economic literature




40


2
















Theoretical models of control and health




M
Frese








Job control and worker health


















The history of the future of the bayesian brain




K
Friston








NeuroImage




62


2
















When effort matters: Expectations of reward and efficacy guide cognitive control allocation




R
Froemer






H
Lin






C
K D
Wolf






M
Inzlicht






A
Shenhav












bioRxiv








Dynamic driver fatigue detection using hidden markov model in real driving condition




R
Fu






H
Wang






W
Zhao








Expert Systems with Applications




63
















The physiology of willpower: Linking blood glucose to self-control




M
T
Gailliot






R
F
Baumeister








Personality and Social Psychology Review




11


4
















Self-control relies on glucose as a limited energy source: Willpower is more than a metaphor




M
T
Gailliot






R
F
Baumeister






C
N
Dewall






J
K
Maner






E
A
Plant






D
M
Tice






L
E
Brewer






B
J
Schmeichel








Journal of Personality and Social Psychology




92


2


325














Computational rationality: A converging paradigm for intelligence in brains, minds, and machines




S
J
Gershman






E
J
Horvitz






J
B
Tenenbaum








Science




349


6245
















Intense self-regulatory effort increases need for conservation and reduces attractiveness of energy-requiring rewards




M
Giacomantonio






J
Jordan






B
Fennis




10.1027/1864-9335/a000395








Social Psychology




50
















When the motivational consequences of ego depletion collide: Conservation dominates over reward-seeking




M
Giacomantonio






J
Jordan






B
M
Fennis






A
Panno








Journal of Experimental Social Psychology




55
















Carbohydrates and mental function: Feeding or impeding the brain?




E
L
Gibson








Nutrition Bulletin




32
















A computational perspective on the roles of affect in cognitive control




I
Grahek






S
Musslick






A
Shenhav








International Journal of Psychophysiology




151
















A discounting framework for choice with delayed and probabilistic rewards




L
Green






J
Myerson








Psychological bulletin




130


5


769














Delay discounting of monetary rewards over a wide range of amounts




L
Green






J
Myerson






L
Oliveira






S
E
Chang








Journal of the Experimental Analysis of Behavior




100


3
















Rational use of cognitive resources: Levels of analysis between the computational and the algorithmic




T
L
Griffiths






F
Lieder






N
D
Goodman








Topics in Cognitive Science




7


2
















Feelings and consumer decision making: The appraisal-tendency framework




S
Han






J
S
Lerner






D
Keltner








Journal of consumer psychology




17


3
















Stress, workload, and fatigue




P
A
Hancock






P
A
Desmond"""

Output: Provide your response as a JSON list in the following format:

[
  {
    "topic_or_construct": "...",
    "measured_by": "...",
    "justification": "..."
  },
  ...
]